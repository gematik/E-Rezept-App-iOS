<!DOCTYPE html>
<html lang="en">
  <head>
    <title>requirements  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="requirements  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
           1.11.0 Docs
        </a>
         (100% documented)
      </p>
    
      <div class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </div>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/gematik/E-Rezept-App-iOS">
            <img class="header-icon" src="img/gh.png" alt="GitHub"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html"> Reference</a>
      <img class="carat" src="img/carat.png" alt=""/>
      requirements  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="modules.html">Modules</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="error_handling.html">error_handling</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="requirement-notes.html">requirement-notes</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="requirements.html">requirements</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes.html#/s:6eRpApp33DefaultErxTaskMatrixCodeGeneratorC">DefaultErxTaskMatrixCodeGenerator</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Colors.html">Colors</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ProfilePicture.html">ProfilePicture</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SFSymbolName.html">SFSymbolName</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/UnicodeCharacter.html">UnicodeCharacter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Validity.html">Validity</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/APDU.html">APDU</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/APDU/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/AVSError.html">AVSError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/AVSError/InternalError.html">– InternalError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/AVSMessage.html">AVSMessage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/AVSMessage.html#/s:3AVS10AVSMessageV6eRpAppE9ValidatorV">– Validator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp16AVSRedeemServiceV">AVSRedeemService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/AVSTransactionCoreDataStore">AVSTransactionCoreDataStore</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/c:@M@eRpApp@objc(cs)AVScannerViewController">AVScannerViewController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/AccessibilityAnnouncementReceiver.html">AccessibilityAnnouncementReceiver</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp0B7VersionV">AppVersion</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ApplicationIdentifier.html">ApplicationIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ApplicationIdentifier/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Array.html">Array</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/BarcodeDetection.html">BarcodeDetection</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/BiometricsSHA256Signer">BiometricsSHA256Signer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/c:@M@eRpApp@objc(cs)CANCameraScannerViewController">CANCameraScannerViewController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CardError.html">CardError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CardVersion2.html">CardVersion2</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CardVersion2/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CardWallExtAuthConfirmationDomain.html">CardWallExtAuthConfirmationDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CardWallExtAuthConfirmationDomain.html#/s:6eRpApp33CardWallExtAuthConfirmationDomainV5ErrorO">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CardWallReadCardDomain.html">CardWallReadCardDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CardWallReadCardDomain/State.html">– State</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ChargeItemDomainServiceAuthenticateResult">ChargeItemDomainServiceAuthenticateResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ChargeItemDomainServiceDeleteResult">ChargeItemDomainServiceDeleteResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ChargeItemDomainServiceFetchResult">ChargeItemDomainServiceFetchResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ChargeItemListDomainServiceGrantResult">ChargeItemListDomainServiceGrantResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ChargeItemListDomainServiceRevokeResult">ChargeItemListDomainServiceRevokeResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/CoreDataController">CoreDataController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/CoreNFCError.html">CoreNFCError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp23DebugDeviceCapabilitiesC">DebugDeviceCapabilities</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ErxConsent">ErxConsent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ErxTask.html">ErxTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ErxTask.html#/Status">– Status</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ErxTaskOrder.html">ErxTaskOrder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ErxTaskOrder.html#/s:6eRpKit12ErxTaskOrderV01eA3AppE9ValidatorV">– Validator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp30ErxTaskRepositoryRedeemServiceV">ErxTaskRepositoryRedeemService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ExtAuthPendingDomain.html">ExtAuthPendingDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ExtAuthPendingDomain.html#/s:6eRpApp20ExtAuthPendingDomainV5ErrorO">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/FHIRClient">FHIRClient</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/FHIRDateFormatter.html">FHIRDateFormatter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/FileControlParameter.html">FileControlParameter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/FileControlParameter/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/FileIdentifier.html">FileIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/FileIdentifier/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/FileManager">FileManager</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Format2Pin.html">Format2Pin</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Format2Pin/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/GemCvCertificate.html">GemCvCertificate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/GemCvCertificate/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/HealthCard.html">HealthCard</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/HealthCard/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/HealthCardCommandBuilder.html">HealthCardCommandBuilder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/HealthCardCommandBuilder/InvalidArgument.html">– InvalidArgument</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/IDPError.html">IDPError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/JWE">JWE</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/JWT">JWT</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/KKAppDirectory.html">KKAppDirectory</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/KKAppDirectory/Entry.html">– Entry</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Key.html">Key</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Key/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/KeyAgreement.html">KeyAgreement</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/KeyAgreement/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/KeyVerifier">KeyVerifier</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/LocationManager.html">LocationManager</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/MainDomain.html">MainDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/MainDomain.html#/s:6eRpApp10MainDomainV5ErrorO">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/NFCCardError.html">NFCCardError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/NFCHealthCardPasswordControllerError.html">NFCHealthCardPasswordControllerError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp25NFCSignatureProviderErrorO">NFCSignatureProviderError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/NFCTagReaderSession.html">NFCTagReaderSession</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/NFCTagReaderSession/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp19OrderCommunicationsV">OrderCommunications</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Password.html">Password</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Password/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/PharmacyCoreDataStore">PharmacyCoreDataStore</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/PharmacyFHIRDataSource.html">PharmacyFHIRDataSource</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/PharmacyFHIRDataSource/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/PharmacyFilterBar.html">PharmacyFilterBar</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/PharmacyFilterBar.html#/s:6eRpApp17PharmacyFilterBarV0D0V">– Filter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/PharmacyRepositoryError.html">PharmacyRepositoryError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp12PrescriptionV">Prescription</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/PrescriptionDetailDomain">PrescriptionDetailDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/PrivateKeyContainer">PrivateKeyContainer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ProfileCoreDataStore.html">ProfileCoreDataStore</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/RedeemMatrixCodeDomain">RedeemMatrixCodeDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp18RedeemServiceErrorO">RedeemServiceError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/RegisteredDevicesDomain">RegisteredDevicesDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ScanCAN.html">ScanCAN</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ScannedErxTask">ScannedErxTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ScannerDomain">ScannerDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp10SchedulersV">Schedulers</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp14ServiceLocatorC">ServiceLocator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp25ServiceLocatorDebugAccessC">ServiceLocatorDebugAccess</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/SharedTask">SharedTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/ShipmentInfoCoreDataStore">ShipmentInfoCoreDataStore</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ShortFileIdentifier.html">ShortFileIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ShortFileIdentifier/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/TokenPayload">TokenPayload</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/TrustAnchor">TrustAnchor</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:10TrustStore0aB5ErrorO">TrustStoreError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp15UIDateFormatterV">UIDateFormatter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/UserDefaults.html">UserDefaults</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions.html#/s:6eRpApp23UserProfileServiceErrorO">UserProfileServiceError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ZXDataMatrixWriter.html">ZXDataMatrixWriter</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MatrixCodeGenerator.html">MatrixCodeGenerator</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ErxTaskRepositoryDependency.html">ErxTaskRepositoryDependency</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/OrdersRepositoryDependency.html">OrdersRepositoryDependency</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ProfileImageView.html">ProfileImageView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ProfileImageView/Size.html">– Size</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:6eRpApp7ScanCANa">ScanCAN</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <h1 id='requirements' class='heading'>Requirements</h1>
<h2 id='gemspec_krypt' class='heading'>gemSpec_Krypt</h2>
<h3 id='a_17124' class='heading'>A_17124</h3>
<h4 id='code-doc-manual-requirement-notes-md-3-code-no-exceptions-set-in-nsapptransportsecurity-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:3</code>:  no exceptions set in NSAppTransportSecurity, see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17322,A_17124,A_21275,A_21332,GS-A_4359,A_21275−01] no exceptions set in NSAppTransportSecurity, see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h3 id='a_17205' class='heading'>A_17205</h3>
<h4 id='code-doc-manual-requirement-notes-md-9-code-the-app-does-not-use-the-tsl-all-tsl-related-parts-are-handled-within-the-erp-fd' class='heading'><code>../doc/manual/requirement-notes.md:9</code>:  The app does not use the TSL. All TSL related parts are handled within the eRp-FD.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17205] The app does not use the TSL. All TSL related parts are handled within the eRp-FD.
</code></pre>
<h3 id='a_17207' class='heading'>A_17207</h3>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-481-code-assure-only-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:481</code>:  Assure only brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
var alg: JWT.Algorithm? {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-280-code-only-implemented-for-brainpoolp256r1' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:280</code>:  Only implemented for brainpoolP256r1</h4>
<pre class="highlight plaintext"><code>// Validate JWT/DiscoveryDocument signature
// [REQ:gemSpec_Krypt:A_17207] Only implemented for brainpoolP256r1
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard (try? fetchedDocument.backing.verify(with: fetchedDocument.discKey)) ?? false else {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-618-code-only-implemented-for-brainpoolp256r1' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:618</code>:  Only implemented for brainpoolP256r1</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Only implemented for brainpoolP256r1
// [REQ:gemSpec_IDP_Frontend:A_19908-01] Signature check
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let verified = try? challenge.challenge.verify(with: document.authentication.cert),
</code></pre>
<h4 id='code-sources-idp-internal-jwt-jwtsignatureverifier-swift-23-code' class='heading'><code>../Sources/IDP/internal/JWT/JWTSignatureVerifier.swift:23</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207]
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02]
public func verify(signature raw: Data, message: Data) throws -&gt; Bool {
</code></pre>
<h4 id='code-sources-idp-internal-jwt-jwtsignatureverifier-swift-33-code' class='heading'><code>../Sources/IDP/internal/JWT/JWTSignatureVerifier.swift:33</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207]
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let key = brainpoolP256r1VerifyPublicKey() else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-19-code-assure-only-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:19</code>:  Assure only brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let alg = certificate.info.algorithm.alg else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-45-code-assure-only-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:45</code>:  Assure only brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard certificate.info.algorithm.alg == .bp256r1 else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-429-code-assure-only-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:429</code>:  Assure only brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let alg = certificate.info.algorithm.alg else {
</code></pre>
<h4 id='code-doc-manual-requirement-notes-md-1-code-brainpoolp256r1-ist-used-for-creating-verifying-key-for-signature-usage-exception-biometric-use-case-uses-secp256r1-is-considered-in-repective-specification' class='heading'><code>../doc/manual/requirement-notes.md:1</code>:  brainpoolP256r1 ist used for creating/verifying key for signature usage; exception: Biometric use case uses secp256r1 (is considered in repective specification)</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17207,A_17359] brainpoolP256r1 ist used for creating/verifying key for signature usage; exception: Biometric use case uses secp256r1 (is considered in repective specification)
</code></pre>
<h3 id='a_17322' class='heading'>A_17322</h3>
<h4 id='code-doc-manual-requirement-notes-md-3-code-no-exceptions-set-in-nsapptransportsecurity-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:3</code>:  no exceptions set in NSAppTransportSecurity, see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17322,A_17124,A_21275,A_21332,GS-A_4359,A_21275−01] no exceptions set in NSAppTransportSecurity, see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h3 id='a_17359' class='heading'>A_17359</h3>
<h4 id='code-doc-manual-requirement-notes-md-1-code-brainpoolp256r1-ist-used-for-creating-verifying-key-for-signature-usage-exception-biometric-use-case-uses-secp256r1-is-considered-in-repective-specification' class='heading'><code>../doc/manual/requirement-notes.md:1</code>:  brainpoolP256r1 ist used for creating/verifying key for signature usage; exception: Biometric use case uses secp256r1 (is considered in repective specification)</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17207,A_17359] brainpoolP256r1 ist used for creating/verifying key for signature usage; exception: Biometric use case uses secp256r1 (is considered in repective specification)
</code></pre>
<h3 id='a_17775' class='heading'>A_17775</h3>
<h4 id='code-doc-manual-requirement-notes-md-10-code-we-cannot-interfere-with-cipher-suite-lists-see-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a-for-actual-order' class='heading'><code>../doc/manual/requirement-notes.md:10</code>:  We cannot interfere with cipher suite lists, see <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a> for actual order.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17775,GS−A_5339] We cannot interfere with cipher suite lists, see [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html) for actual order.
</code></pre>
<h3 id='a_18464' class='heading'>A_18464</h3>
<h4 id='code-sources-httpclient-defaulthttpclient-swift-35-code' class='heading'><code>../Sources/HTTPClient/DefaultHTTPClient.swift:35</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4385,A_18467,A_18464,GS-A_4387]
// [REQ:gemSpec_Krypt:GS-A_5322] TODO: Check if limiting SSL Sessions is possible, check for renegotiation
// swiftlint:disable:previous todo
// [REQ:gemSpec_IDP_Frontend:A_20606] Live URLs not present in NSAppTransportSecurity exception list for allowed
// HTTP communication
// [REQ:gemSpec_eRp_FdV:A_20206]

</code></pre>
<h3 id='a_18467' class='heading'>A_18467</h3>
<h4 id='code-sources-httpclient-defaulthttpclient-swift-35-code' class='heading'><code>../Sources/HTTPClient/DefaultHTTPClient.swift:35</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4385,A_18467,A_18464,GS-A_4387]
// [REQ:gemSpec_Krypt:GS-A_5322] TODO: Check if limiting SSL Sessions is possible, check for renegotiation
// swiftlint:disable:previous todo
// [REQ:gemSpec_IDP_Frontend:A_20606] Live URLs not present in NSAppTransportSecurity exception list for allowed
// HTTP communication
// [REQ:gemSpec_eRp_FdV:A_20206]

</code></pre>
<h3 id='a_19215' class='heading'>A_19215</h3>
<h4 id='code-doc-manual-requirement-notes-md-11-code-we-use-https-only-see-code-defaulthttpclient-swift-code-ats-forbidds-other-connections' class='heading'><code>../doc/manual/requirement-notes.md:11</code>:  We use https only, see <code>DefaultHTTPClient.swift</code>. ATS forbidds other connections.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:GS−A_5035,A_19215,A_20607] We use https only, see `DefaultHTTPClient.swift`. ATS forbidds other connections.
</code></pre>
<h3 id='a_20161-01' class='heading'>A_20161-01</h3>
<h4 id='code-sources-vau-vauinterceptor-swift-46-code' class='heading'><code>../Sources/VAU/VAUInterceptor.swift:46</code>:</h4>
<pre class="highlight plaintext"><code>// Prepare outer request (encrypt original request and embed it into a new one)
// [REQ:gemSpec_Krypt:A_20161-01]
.processToVauRequest(urlRequest: request, vauCryptoProvider: vauCryptoProvider)
</code></pre>
<h4 id='code-sources-vau-vauinterceptor-swift-62-code' class='heading'><code>../Sources/VAU/VAUInterceptor.swift:62</code>:</h4>
<pre class="highlight plaintext"><code>// Prepare outer request (encrypt original request and embed it into a new one)
// [REQ:gemSpec_Krypt:A_20161-01]
func processToVauRequest(
</code></pre>
<h4 id='code-sources-vau-internal-vaucrypto-swift-26-code' class='heading'><code>../Sources/VAU/internal/VAUCrypto.swift:26</code>:</h4>
<pre class="highlight plaintext"><code>/// Perform encryption of the data that the implementing instance has been initialized with
/// in order to send it to a VAU service endpoint. See: gemSpec_Krypt A_20161-01
///
/// [REQ:gemSpec_Krypt:A_20161-01]
///
/// - Returns: Encrypted HTTPRequest as specified to be sent to a VAU endpoint
/// - Throws: `VAUError` in case of encryption failure
func encrypt() throws -&gt; Data
</code></pre>
<h4 id='5-code-sources-vau-internal-vaucrypto-swift-87-code' class='heading'>5 <code>../Sources/VAU/internal/VAUCrypto.swift:87</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_20161-01:5]
guard let payload = "1 \(bearerToken) \(requestId) \(symKeyHex) \(message)".data(using: .utf8) else {
</code></pre>
<h4 id='6a-g-code-sources-vau-internal-vaucrypto-swift-131-code' class='heading'>6a-g <code>../Sources/VAU/internal/VAUCrypto.swift:131</code>:</h4>
<pre class="highlight plaintext"><code>/// Perform Elliptic Curve Integrated Encryption Scheme [SEC1-2009] on some payload
/// [REQ:gemSpec_Krypt:A_20161-01:6a-g]
static func encrypt(
</code></pre>
<h3 id='a_20163' class='heading'>A_20163</h3>
<h4 id='code-sources-vau-internal-vaucrypto-swift-34-code' class='heading'><code>../Sources/VAU/internal/VAUCrypto.swift:34</code>:</h4>
<pre class="highlight plaintext"><code>/// Perform decryption and validation of given data with the secret key material the implementing instance holds.
///
/// [REQ:gemSpec_Krypt:A_20163]
///
/// - Parameter data: Data to be decrypted
/// - Returns: Decrypted UTF8 string representation of the given data
/// - Throws: `VAUError` in case of decryption failure or when the decrypted data could not be validated
func decrypt(data: Data) throws -&gt; String
</code></pre>
<h3 id='a_20174' class='heading'>A_20174</h3>
<h4 id='code-sources-vau-vauinterceptor-swift-51-code' class='heading'><code>../Sources/VAU/VAUInterceptor.swift:51</code>:</h4>
<pre class="highlight plaintext"><code>// Process VAU server response (validate and extract+decrypt inner FHIR service response)
// [REQ:gemSpec_Krypt:A_20174]
.handleUserPseudonym(vauEndpointHandler: self.vauEndpointHandler)
</code></pre>
<h4 id='code-sources-vau-vauinterceptor-swift-129-code' class='heading'><code>../Sources/VAU/VAUInterceptor.swift:129</code>:</h4>
<pre class="highlight plaintext"><code>// Process VAU server response (validate and extract+decrypt inner FHIR service response)
// [REQ:gemSpec_Krypt:A_20174]
static func processVauResponse(httpResponse: HTTPResponse, vauCrypto: VAUCrypto, originalUrl: URL) throws
</code></pre>
<h4 id='3-code-sources-vau-internal-vaucrypto-swift-108-code-decrypt-using-aes-symmetric-key' class='heading'>3 <code>../Sources/VAU/internal/VAUCrypto.swift:108</code>:  Decrypt using AES symmetric key</h4>
<pre class="highlight plaintext"><code>// Steps according to gemSpec_Krypt A_20174
// [REQ:gemSpec_Krypt:A_20174:3] Decrypt using AES symmetric key
guard let sealed = try? AES.GCM.SealedBox(combined: data),
</code></pre>
<h4 id='4-5-code-sources-vau-internal-vaucrypto-swift-115-code-verify-decrypted-message-expect-quot-1-request-id-response-header-and-body-quot' class='heading'>4,5 <code>../Sources/VAU/internal/VAUCrypto.swift:115</code>:  Verify decrypted message. Expect: &ldquo;1 <request id> <response header and body>&rdquo;</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_20174:4,5] Verify decrypted message. Expect: "1 &lt;request id&gt; &lt;response header and body&gt;"
let separated = utf8.split(separator: " ", maxSplits: 2).map { String($0) }
</code></pre>
<h4 id='2-code-sources-vau-internal-vauendpointhandler-swift-13-code' class='heading'>2 <code>../Sources/VAU/internal/VAUEndpointHandler.swift:13</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_20174:2]
func didReceiveUserPseudonym(in httpResponse: HTTPResponse)
</code></pre>
<h4 id='2-code-sources-vau-internal-vauendpointhandler-swift-34-code' class='heading'>2 <code>../Sources/VAU/internal/VAUEndpointHandler.swift:34</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_20174:2]
if let pseudonym = httpResponse.response.value(forHTTPHeaderField: "userpseudonym") {
</code></pre>
<h3 id='a_20175' class='heading'>A_20175</h3>
<h4 id='code-sources-vau-vaustorage-swift-15-code' class='heading'><code>../Sources/VAU/VAUStorage.swift:15</code>:</h4>
<pre class="highlight plaintext"><code>/// Retrieve a previously saved UserPseudonym
///
/// [REQ:gemSpec_Krypt:A_20175]
var userPseudonym: AnyPublisher&lt;String?, Never&gt; { get }
</code></pre>
<h4 id='code-sources-vau-vaustorage-swift-22-code' class='heading'><code>../Sources/VAU/VAUStorage.swift:22</code>:</h4>
<pre class="highlight plaintext"><code>/// Set and save a user pseudonym
///
/// [REQ:gemSpec_Krypt:A_20175]
///
/// - Parameter userPseudonym: value to save. Pass in nil to unset
func set(userPseudonym: String?)
</code></pre>
<h3 id='a_20607' class='heading'>A_20607</h3>
<h4 id='code-doc-manual-requirement-notes-md-11-code-we-use-https-only-see-code-defaulthttpclient-swift-code-ats-forbidds-other-connections' class='heading'><code>../doc/manual/requirement-notes.md:11</code>:  We use https only, see <code>DefaultHTTPClient.swift</code>. ATS forbidds other connections.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:GS−A_5035,A_19215,A_20607] We use https only, see `DefaultHTTPClient.swift`. ATS forbidds other connections.
</code></pre>
<h3 id='a_21216' class='heading'>A_21216</h3>
<h4 id='code-sources-truststore-internal-certlist-swift-11-code' class='heading'><code>../Sources/TrustStore/internal/CertList.swift:11</code>:</h4>
<pre class="highlight plaintext"><code>/// Data structure according to */CertList* endpoint
/// [REQ:gemSpec_Krypt:A_21216]
public struct CertList: Codable, Equatable {
</code></pre>
<h4 id='code-sources-vau-internal-vaucertlist-swift-11-code' class='heading'><code>../Sources/VAU/internal/VAUCertList.swift:11</code>:</h4>
<pre class="highlight plaintext"><code>/// Data structure according to */CertList* endpoint
/// [REQ:gemSpec_Krypt:A_21216]
public struct VAUCertList: Codable, Equatable {
</code></pre>
<h3 id='a_21217' class='heading'>A_21217</h3>
<h4 id='code-sources-truststore-internal-ocsplist-swift-10-code' class='heading'><code>../Sources/TrustStore/internal/OCSPList.swift:10</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_Krypt:A_21217]
/// Data structure according to */OCSPList* endpoint
public struct OCSPList: Codable, Equatable {
</code></pre>
<h3 id='a_21218' class='heading'>A_21218</h3>
<h4 id='code-sources-erpapp-appconfiguration-swift-94-code-gematik-root-ca-3-as-a-trust-anchor-has-to-be-set-in-the-program-code' class='heading'><code>../Sources/eRpApp/AppConfiguration.swift:94</code>:  Gematik Root CA 3 as a trust anchor has to be set in the program code</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] Gematik Root CA 3 as a trust anchor has to be set in the program code
// swiftlint:disable:next force_try
let TRUSTANCHOR_GemRootCa3 = try! TrustAnchor(withPEM: """
</code></pre>
<h4 id='code-sources-truststore-defaulttruststoresession-swift-68-code' class='heading'><code>../Sources/TrustStore/DefaultTrustStoreSession.swift:68</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218,A_21222]
extension DefaultTrustStoreSession: TrustStoreSession {
</code></pre>
<h4 id='code-sources-truststore-defaulttruststoresession-swift-178-code' class='heading'><code>../Sources/TrustStore/DefaultTrustStoreSession.swift:178</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218]
func loadOCSPResponses() -&gt; AnyPublisher&lt;[OCSPResponse], TrustStoreError&gt; {
</code></pre>
<h4 id='code-sources-truststore-defaulttruststoresession-swift-191-code-if-only-ocsp-responses-gt-12h-available-we-must-request-new-ones' class='heading'><code>../Sources/TrustStore/DefaultTrustStoreSession.swift:191</code>:  If only OCSP responses &gt;12h available, we must request new ones</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] If only OCSP responses &gt;12h available, we must request new ones
ocspResponses
</code></pre>
<h4 id='code-sources-truststore-defaulttruststoresession-swift-209-code-if-only-ocsp-responses-gt-12h-available' class='heading'><code>../Sources/TrustStore/DefaultTrustStoreSession.swift:209</code>:  If only OCSP responses &gt;12h available, &hellip;</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] If only OCSP responses &gt;12h available, ...
ocspResponses
</code></pre>
<h4 id='code-sources-truststore-defaulttruststoresession-swift-233-code-if-only-ocsp-responses-gt-12h-available-we-must-request-new-ones' class='heading'><code>../Sources/TrustStore/DefaultTrustStoreSession.swift:233</code>:  If only OCSP responses &gt;12h available, we must request new ones</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] If only OCSP responses &gt;12h available, we must request new ones
func allSatisfyNotProducedBefore(date: Date) -&gt; Bool {
</code></pre>
<h4 id='code-sources-truststore-truststoresession-swift-13-code' class='heading'><code>../Sources/TrustStore/TrustStoreSession.swift:13</code>:</h4>
<pre class="highlight plaintext"><code>/// TrustStoreSession acts as an interactor/mediator for the TrustStoreClient and TrustStoreStorage
///
/// [REQ:gemSpec_Krypt:A_21218,A_21222]
public protocol TrustStoreSession {
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-13-code' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:13</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218]
// [REQ:gemSpec_eRp_FdV:A_20032-01]
// Category A: Cross root certificates
private let rootCa: X509
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-105-code' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:105</code>:</h4>
<pre class="highlight plaintext"><code>/// Match a collection of `OCSPResponse`s with the end entity certificates of this `X509TrustStore`.
/// Checks response status, revocation status for each certificate and validates the signer certificates of
///   the responses itself.
///
/// [REQ:gemSpec_Krypt:A_21218]
/// [REQ:gemSpec_eRp_Fdv:A_20032-01]
///
/// - Note: This function assumes that up-to-dateness of the responses itself has already been checked.
///
/// - Returns: true on successful matching/validation, false if not successful or error
func checkEeCertificatesStatus(with ocspResponses: [OCSPResponse]) throws -&gt; Bool {
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-103-code-ocsp-responder-certificates-must-be-verifiable-by-the-trust-store' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:103</code>:  OCSP responder certificates must be verifiable by the trust store</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] OCSP responder certificates must be verifiable by the trust store
let verifiedOCSPResponses = basicVerifyFilter(ocspResponses: ocspResponses)
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-111-code-for-every-ee-certificate-there-must-be-a-matching-ocsp-response' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:111</code>:  For every EE certificate there must be a matching OCSP response</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] For every EE certificate there must be a matching OCSP response
let matchedResponses = try eeCertAndSignerTuple.map { eeCertificate, signer in
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-119-code-for-every-ocsp-response-there-must-be-a-matching-ee-certificate' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:119</code>:  For every OCSP response there must be a matching EE certificate</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] For every OCSP response there must be a matching EE certificate
let matchedEeCerts = try ocspResponses.map { response in
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-130-code-ocsp-responder-certificates-must-be-verifiable-by-the-trust-store' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:130</code>:  OCSP responder certificates must be verifiable by the trust store</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218] OCSP responder certificates must be verifiable by the trust store
private func basicVerifyFilter(ocspResponses: [OCSPResponse]) -&gt; [OCSPResponse] {
</code></pre>
<h4 id='3-code-sources-truststore-x509truststore-swift-151-code-check-ca_certs-against-category-a-certificates' class='heading'>(3) <code>../Sources/TrustStore/X509TrustStore.swift:151</code>:  Check ca_certs against category A certificates</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218:(3)] Check ca_certs against category A certificates
private static let caCertRegex =
</code></pre>
<h4 id='4-code-sources-truststore-x509truststore-swift-168-code-check-ee_certs-against-category-a-b-certificates' class='heading'>(4) <code>../Sources/TrustStore/X509TrustStore.swift:168</code>:  Check ee_certs against category A+B certificates</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218:(4)] Check ee_certs against category A+B certificates
typealias VauAndIpdCerts = (vauCerts: [X509], idpCerts: [X509])
</code></pre>
<h4 id='code-doc-manual-requirement-notes-md-5-code-note-grace-period-for-ocsp-responses-is-12h' class='heading'><code>../doc/manual/requirement-notes.md:5</code>:  Note: grace period for OCSP responses is 12h</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_21218] Note: grace period for OCSP responses is 12h
</code></pre>
<h3 id='a_21222' class='heading'>A_21222</h3>
<h4 id='code-sources-truststore-defaulttruststoresession-swift-68-code' class='heading'><code>../Sources/TrustStore/DefaultTrustStoreSession.swift:68</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218,A_21222]
extension DefaultTrustStoreSession: TrustStoreSession {
</code></pre>
<h4 id='code-sources-truststore-truststoresession-swift-13-code' class='heading'><code>../Sources/TrustStore/TrustStoreSession.swift:13</code>:</h4>
<pre class="highlight plaintext"><code>/// TrustStoreSession acts as an interactor/mediator for the TrustStoreClient and TrustStoreStorage
///
/// [REQ:gemSpec_Krypt:A_21218,A_21222]
public protocol TrustStoreSession {
</code></pre>
<h3 id='a_21275' class='heading'>A_21275</h3>
<h4 id='code-doc-manual-requirement-notes-md-3-code-no-exceptions-set-in-nsapptransportsecurity-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:3</code>:  no exceptions set in NSAppTransportSecurity, see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17322,A_17124,A_21275,A_21332,GS-A_4359,A_21275−01] no exceptions set in NSAppTransportSecurity, see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h3 id='a_21275-01' class='heading'>A_21275−01</h3>
<h4 id='code-doc-manual-requirement-notes-md-3-code-no-exceptions-set-in-nsapptransportsecurity-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:3</code>:  no exceptions set in NSAppTransportSecurity, see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17322,A_17124,A_21275,A_21332,GS-A_4359,A_21275−01] no exceptions set in NSAppTransportSecurity, see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h3 id='a_21332' class='heading'>A_21332</h3>
<h4 id='code-doc-manual-requirement-notes-md-3-code-no-exceptions-set-in-nsapptransportsecurity-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:3</code>:  no exceptions set in NSAppTransportSecurity, see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17322,A_17124,A_21275,A_21332,GS-A_4359,A_21275−01] no exceptions set in NSAppTransportSecurity, see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h3 id='a_4389' class='heading'>A_4389</h3>
<h4 id='1-code-sources-vau-internal-vaucrypto-swift-91-code-ivs-must-not-be-reused-ivs-bit-length-must-be-larger-or-equal-to-96' class='heading'>1 <code>../Sources/VAU/internal/VAUCrypto.swift:91</code>:  IVs must not be reused, IVs bit length must be larger or equal to 96</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_4389:1] IVs must not be reused, IVs bit length must be larger or equal to 96
let nonceGenerator = { try VAURandom.generateSecureRandom(length: self.eciesSpec.ivSize) }
</code></pre>
<h3 id='gs-a_4357' class='heading'>GS-A_4357</h3>
<h4 id='code-sources-idp-internal-idpcrypto-swift-15-code-key-pair-generation-delegated-to-openssl-with-brainpoolp256r1-parameters' class='heading'><code>../Sources/IDP/internal/IDPCrypto.swift:15</code>:  Key pair generation delegated to OpenSSL with BrainpoolP256r1 parameters</h4>
<pre class="highlight plaintext"><code>/// Key-pair generator type based on BrainpoolP256r1
///
/// [REQ:gemSpec_Krypt:GS-A_4357] Key pair generation delegated to OpenSSL with BrainpoolP256r1 parameters
public typealias BrainpoolKeyGenerator = () throws -&gt; BrainpoolP256r1.KeyExchange.PrivateKey
</code></pre>
<h4 id='code-sources-idp-internal-jwt-jwe-kdf-swift-30-code-key-pair-generation-delegated-to-openssl-with-brainpoolp256r1-parameters' class='heading'><code>../Sources/IDP/internal/JWT/JWE+KDF.swift:30</code>:  Key pair generation delegated to OpenSSL with BrainpoolP256r1 parameters</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4357] Key pair generation delegated to OpenSSL with BrainpoolP256r1 parameters
case bpp256r1(BrainpoolP256r1.KeyExchange.PublicKey,
</code></pre>
<h4 id='code-sources-vau-internal-vaucrypto-swift-93-code-key-pair-generation-delegated-to-openssl-with-brainpoolp256r1-parameters' class='heading'><code>../Sources/VAU/internal/VAUCrypto.swift:93</code>:  Key pair generation delegated to OpenSSL with BrainpoolP256r1 parameters</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4357] Key pair generation delegated to OpenSSL with BrainpoolP256r1 parameters
let keyPairGenerator = { try BrainpoolP256r1.KeyExchange.generateKey() }
</code></pre>
<h3 id='gs-a_4357-01' class='heading'>GS-A_4357-01</h3>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-482-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:482</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
var alg: JWT.Algorithm? {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-620-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:620</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Only implemented for brainpoolP256r1
// [REQ:gemSpec_IDP_Frontend:A_19908-01] Signature check
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let verified = try? challenge.challenge.verify(with: document.authentication.cert),
</code></pre>
<h4 id='code-sources-idp-internal-jwt-jwtsignatureverifier-swift-24-code' class='heading'><code>../Sources/IDP/internal/JWT/JWTSignatureVerifier.swift:24</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207]
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02]
public func verify(signature raw: Data, message: Data) throws -&gt; Bool {
</code></pre>
<h4 id='code-sources-idp-internal-jwt-jwtsignatureverifier-swift-34-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/IDP/internal/JWT/JWTSignatureVerifier.swift:34</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207]
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let key = brainpoolP256r1VerifyPublicKey() else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-20-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:20</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let alg = certificate.info.algorithm.alg else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-46-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:46</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard certificate.info.algorithm.alg == .bp256r1 else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-430-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:430</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let alg = certificate.info.algorithm.alg else {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-281-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:281</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// Validate JWT/DiscoveryDocument signature
// [REQ:gemSpec_Krypt:A_17207] Only implemented for brainpoolP256r1
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard (try? fetchedDocument.backing.verify(with: fetchedDocument.discKey)) ?? false else {
</code></pre>
<h3 id='gs-a_4357-02' class='heading'>GS-A_4357-02</h3>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-482-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:482</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
var alg: JWT.Algorithm? {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-620-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:620</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Only implemented for brainpoolP256r1
// [REQ:gemSpec_IDP_Frontend:A_19908-01] Signature check
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let verified = try? challenge.challenge.verify(with: document.authentication.cert),
</code></pre>
<h4 id='code-sources-idp-internal-jwt-jwtsignatureverifier-swift-24-code' class='heading'><code>../Sources/IDP/internal/JWT/JWTSignatureVerifier.swift:24</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207]
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02]
public func verify(signature raw: Data, message: Data) throws -&gt; Bool {
</code></pre>
<h4 id='code-sources-idp-internal-jwt-jwtsignatureverifier-swift-34-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/IDP/internal/JWT/JWTSignatureVerifier.swift:34</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207]
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let key = brainpoolP256r1VerifyPublicKey() else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-20-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:20</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let alg = certificate.info.algorithm.alg else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-46-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:46</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard certificate.info.algorithm.alg == .bp256r1 else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-430-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:430</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Assure only brainpoolP256r1 is used
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let alg = certificate.info.algorithm.alg else {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-281-code-assure-that-brainpoolp256r1-is-used' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:281</code>:  Assure that brainpoolP256r1 is used</h4>
<pre class="highlight plaintext"><code>// Validate JWT/DiscoveryDocument signature
// [REQ:gemSpec_Krypt:A_17207] Only implemented for brainpoolP256r1
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard (try? fetchedDocument.backing.verify(with: fetchedDocument.discKey)) ?? false else {
</code></pre>
<h3 id='gs-a_4359' class='heading'>GS-A_4359</h3>
<h4 id='code-doc-manual-requirement-notes-md-3-code-no-exceptions-set-in-nsapptransportsecurity-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:3</code>:  no exceptions set in NSAppTransportSecurity, see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17322,A_17124,A_21275,A_21332,GS-A_4359,A_21275−01] no exceptions set in NSAppTransportSecurity, see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h3 id='gs-a_4367' class='heading'>GS-A_4367</h3>
<h4 id='code-sources-idp-internal-seckeyrandom-swift-19-code' class='heading'><code>../Sources/IDP/internal/SecKeyRandom.swift:19</code>:</h4>
<pre class="highlight plaintext"><code>/// Generate random Data with given length
///
/// [REQ:gemSpec_Krypt:GS-A_4367]
///
/// - Parameters:
///   - length: the number of bytes to generate
///   - randomizer: the randomizer to be used. Default: kSecRandomDefault
/// - Returns: the random initialized Data
/// - Throws: `IDPError`
public func generateSecureRandom(length: Int, randomizer: SecRandomRef? = kSecRandomDefault) throws -&gt; Data {
</code></pre>
<h4 id='code-sources-vau-internal-vaurandom-swift-20-code' class='heading'><code>../Sources/VAU/internal/VAURandom.swift:20</code>:</h4>
<pre class="highlight plaintext"><code>/// Generate random Data with given length
///
/// [REQ:gemSpec_Krypt:GS-A_4367]
///
/// - Parameters:
///   - length: the number of bytes to generate
///   - randomizer: the randomizer to be used. Default: kSecRandomDefault
/// - Returns: the random initialized Data
/// - Throws: `VAUError`
static func generateSecureRandom(length: Int, randomizer: SecRandomRef? = kSecRandomDefault) throws -&gt; Data {
</code></pre>
<h3 id='gs-a_4385' class='heading'>GS-A_4385</h3>
<h4 id='code-sources-httpclient-defaulthttpclient-swift-35-code' class='heading'><code>../Sources/HTTPClient/DefaultHTTPClient.swift:35</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4385,A_18467,A_18464,GS-A_4387]
// [REQ:gemSpec_Krypt:GS-A_5322] TODO: Check if limiting SSL Sessions is possible, check for renegotiation
// swiftlint:disable:previous todo
// [REQ:gemSpec_IDP_Frontend:A_20606] Live URLs not present in NSAppTransportSecurity exception list for allowed
// HTTP communication
// [REQ:gemSpec_eRp_FdV:A_20206]

</code></pre>
<h3 id='gs-a_4387' class='heading'>GS-A_4387</h3>
<h4 id='code-sources-httpclient-defaulthttpclient-swift-35-code' class='heading'><code>../Sources/HTTPClient/DefaultHTTPClient.swift:35</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4385,A_18467,A_18464,GS-A_4387]
// [REQ:gemSpec_Krypt:GS-A_5322] TODO: Check if limiting SSL Sessions is possible, check for renegotiation
// swiftlint:disable:previous todo
// [REQ:gemSpec_IDP_Frontend:A_20606] Live URLs not present in NSAppTransportSecurity exception list for allowed
// HTTP communication
// [REQ:gemSpec_eRp_FdV:A_20206]

</code></pre>
<h3 id='gs-a_4389' class='heading'>GS-A_4389</h3>
<h4 id='2-code-sources-idp-internal-idpcrypto-swift-46-code-ivs-must-not-be-reused-ivs-bit-length-must-be-larger-or-equal-to-96' class='heading'>2 <code>../Sources/IDP/internal/IDPCrypto.swift:46</code>:  IVs must not be reused, IVs bit length must be larger or equal to 96</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4389:2] IVs must not be reused, IVs bit length must be larger or equal to 96
try generateSecureRandom(length: IDPCrypto.AES256GCMSpec.nonceBytes)
</code></pre>
<h4 id='1-code-sources-idp-internal-idpcrypto-swift-49-code-256bit-gcm-symmetric-key' class='heading'>1 <code>../Sources/IDP/internal/IDPCrypto.swift:49</code>:  256bit GCM symmetric key</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4389:1] 256bit GCM symmetric key
aesKey: SymmetricKey = SymmetricKey(size: SymmetricKeySize(bitCount: 256))
</code></pre>
<h4 id='2-code-sources-vau-internal-vaucrypto-swift-141-code-256bit-gcm-symmetric-key' class='heading'>2 <code>../Sources/VAU/internal/VAUCrypto.swift:141</code>:  256bit GCM symmetric key</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4389:2] 256bit GCM symmetric key
let secretKey = SymmetricKey(data: sharedSecret)
</code></pre>
<h4 id='1-code-sources-vau-internal-vaucrypto-swift-160-code-256bit-gcm-symmetric-key' class='heading'>1 <code>../Sources/VAU/internal/VAUCrypto.swift:160</code>:  256bit GCM symmetric key</h4>
<pre class="highlight plaintext"><code>// f) Encrypt
// [REQ:gemSpec_Krypt:GS-A_4389:1] 256bit GCM symmetric key
let sealedBox = try AES.GCM.seal(payload, using: cek, nonce: nonce)
</code></pre>
<h3 id='gs-a_4390' class='heading'>GS-A_4390</h3>
<h4 id='code-sources-avs-avscmsencrypter-swift-17-code-rsaes-oaep-with-mgf1-implemented-in-sub-framework-openssl-swift' class='heading'><code>../Sources/AVS/AVSCmsEncrypter.swift:17</code>:  RSAES-OAEP with MGF1 implemented in sub-framework OpenSSL-swift</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4390] RSAES-OAEP with MGF1 implemented in sub-framework OpenSSL-swift
// https://github.com/gematik/OpenSSL-Swift/blob/3c1ea91ba5abfefecfe3588815cb928d777e29ad/Sources/OpenSSL/CMS/CMSContentInfo.swift#L88
// swiftlint:disable:previous line_length
let cms = try CMSContentInfo.encryptPartial(data: data)
</code></pre>
<h3 id='gs-a_5322' class='heading'>GS-A_5322</h3>
<h4 id='code-sources-httpclient-defaulthttpclient-swift-36-code-todo-check-if-limiting-ssl-sessions-is-possible-check-for-renegotiation' class='heading'><code>../Sources/HTTPClient/DefaultHTTPClient.swift:36</code>:  TODO: Check if limiting SSL Sessions is possible, check for renegotiation</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4385,A_18467,A_18464,GS-A_4387]
// [REQ:gemSpec_Krypt:GS-A_5322] TODO: Check if limiting SSL Sessions is possible, check for renegotiation
// swiftlint:disable:previous todo
// [REQ:gemSpec_IDP_Frontend:A_20606] Live URLs not present in NSAppTransportSecurity exception list for allowed
// HTTP communication
// [REQ:gemSpec_eRp_FdV:A_20206]

</code></pre>
<h3 id='gs-a_5035' class='heading'>GS−A_5035</h3>
<h4 id='code-doc-manual-requirement-notes-md-11-code-we-use-https-only-see-code-defaulthttpclient-swift-code-ats-forbidds-other-connections' class='heading'><code>../doc/manual/requirement-notes.md:11</code>:  We use https only, see <code>DefaultHTTPClient.swift</code>. ATS forbidds other connections.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:GS−A_5035,A_19215,A_20607] We use https only, see `DefaultHTTPClient.swift`. ATS forbidds other connections.
</code></pre>
<h3 id='gs-a_5322' class='heading'>GS−A_5322</h3>
<h4 id='code-doc-manual-requirement-notes-md-12-code-there-is-no-api-to-control-the-session-length-developer-forums-suggest-it-is-10-minutes-for-ios' class='heading'><code>../doc/manual/requirement-notes.md:12</code>:  There is no API to control the session length, developer forums suggest it is 10 minutes for iOS.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:GS−A_5322] There is no API to control the session length, developer forums suggest it is 10 minutes for iOS.
</code></pre>
<h3 id='gs-a_5339' class='heading'>GS−A_5339</h3>
<h4 id='code-doc-manual-requirement-notes-md-10-code-we-cannot-interfere-with-cipher-suite-lists-see-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a-for-actual-order' class='heading'><code>../doc/manual/requirement-notes.md:10</code>:  We cannot interfere with cipher suite lists, see <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a> for actual order.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:A_17775,GS−A_5339] We cannot interfere with cipher suite lists, see [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html) for actual order.
</code></pre>
<h3 id='gs-a_5526' class='heading'>GS−A_5526</h3>
<h4 id='code-doc-manual-requirement-notes-md-13-code-we-use-the-recommended-nsurlsession-for-best-network-security-a-href-https-developer-apple-com-documentation-security-preventing_insecure_network_connections-preventing-insecure-network-connections-a' class='heading'><code>../doc/manual/requirement-notes.md:13</code>:  We use the recommended NSURLSession for best network security <a href="https://developer.apple.com/documentation/security/preventing_insecure_network_connections">Preventing insecure network connections</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:GS−A_5526,GS−A_5542] We use the recommended NSURLSession for best network security [Preventing insecure network connections](https://developer.apple.com/documentation/security/preventing_insecure_network_connections)
</code></pre>
<h3 id='gs-a_5542' class='heading'>GS−A_5542</h3>
<h4 id='code-doc-manual-requirement-notes-md-13-code-we-use-the-recommended-nsurlsession-for-best-network-security-a-href-https-developer-apple-com-documentation-security-preventing_insecure_network_connections-preventing-insecure-network-connections-a' class='heading'><code>../doc/manual/requirement-notes.md:13</code>:  We use the recommended NSURLSession for best network security <a href="https://developer.apple.com/documentation/security/preventing_insecure_network_connections">Preventing insecure network connections</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_Krypt:GS−A_5526,GS−A_5542] We use the recommended NSURLSession for best network security [Preventing insecure network connections](https://developer.apple.com/documentation/security/preventing_insecure_network_connections)
</code></pre>
<h2 id='gemspec_idp_frontend' class='heading'>gemSpec_IDP_Frontend</h2>
<h3 id='a_19908-01' class='heading'>A_19908-01</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-619-code-signature-check' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:619</code>:  Signature check</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_17207] Only implemented for brainpoolP256r1
// [REQ:gemSpec_IDP_Frontend:A_19908-01] Signature check
// [REQ:gemSpec_Krypt:GS-A_4357-01,GS-A_4357-02] Assure that brainpoolP256r1 is used
guard let verified = try? challenge.challenge.verify(with: document.authentication.cert),
</code></pre>
<h3 id='a_19937' class='heading'>A_19937</h3>
<h4 id='code-sources-idp-models-idperror-swift-85-code-error-formatting' class='heading'><code>../Sources/IDP/Models/IDPError.swift:85</code>:  Error formatting</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605,A_20085] Error formatting
public var description: String {
</code></pre>
<h4 id='code-sources-idp-internal-realidpclient-swift-499-code-decoding-server-errors' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:499</code>:  Decoding server errors</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605] Decoding server errors
private static func responseError(for body: Data) -&gt; IDPError {
</code></pre>
<h4 id='code-sources-erpapp-common-errorlocalization-idperror-localization-swift-23-code-localized-description-of-server-errors' class='heading'><code>../Sources/eRpApp/Common/ErrorLocalization/IDPError+Localization.swift:23</code>:  Localized description of server errors</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605,A_20085] Localized description of server errors
case let .internal(error: error): return error.localizedDescription
</code></pre>
<h3 id='a_19938-01' class='heading'>A_19938-01</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-201-code-decrypt-fails-if-wrong-aes-key' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:201</code>:  Decrypt, fails if wrong aes key</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19938-01,A_20283-01] Decrypt, fails if wrong aes key
guard let decrypted = try? token.decrypted(with: self.cryptoBox.aesKey) else {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-224-code-usage' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:224</code>:  Usage</h4>
<pre class="highlight plaintext"><code>idToken: decrypted.idToken, // [REQ:gemSpec_IDP_Frontend:A_19938-01] Usage
ssoToken: exchange.sso,
</code></pre>
<h3 id='a_20068-01' class='heading'>A_20068-01</h3>
<h4 id='code-doc-manual-requirement-notes-md-25-code-implemented-with-ats-within-code-info-plist-code-path-code-nsapptransportsecurity-nspinneddomains-code' class='heading'><code>../doc/manual/requirement-notes.md:25</code>: : Implemented with ATS within <code>Info.plist</code>, path: <code>NSAppTransportSecurity.NSPinnedDomains</code></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20608,A_20608-01,A_20609,A_20618,A_20068-01]: Implemented with ATS within `Info.plist`, path: `NSAppTransportSecurity.NSPinnedDomains`
</code></pre>
<h3 id='a_20079' class='heading'>A_20079</h3>
<h4 id='code-sources-idp-internal-realidpclient-swift-263-code-network-timeouts-will-traverse-the-queue-as-code-httperror-code-s' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:263</code>:  Network timeouts will traverse the queue as <code>HTTPError</code>s.</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20079] Network timeouts will traverse the queue as `HTTPError`s.
$0.asIDPError()
</code></pre>
<h3 id='a_20085' class='heading'>A_20085</h3>
<h4 id='code-sources-idp-models-idperror-swift-85-code-error-formatting' class='heading'><code>../Sources/IDP/Models/IDPError.swift:85</code>:  Error formatting</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605,A_20085] Error formatting
public var description: String {
</code></pre>
<h4 id='code-sources-erpapp-common-errorlocalization-idperror-localization-swift-13-code-error-localization-is-not-done-yet-this-is-the-place-to-localize' class='heading'><code>../Sources/eRpApp/Common/ErrorLocalization/IDPError+Localization.swift:13</code>:  Error localization is not done yet, this is the place to localize</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20085] Error localization is not done yet, this is the place to localize
// accordingly.
switch self {
</code></pre>
<h4 id='code-sources-erpapp-common-errorlocalization-idperror-localization-swift-23-code-localized-description-of-server-errors' class='heading'><code>../Sources/eRpApp/Common/ErrorLocalization/IDPError+Localization.swift:23</code>:  Localized description of server errors</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605,A_20085] Localized description of server errors
case let .internal(error: error): return error.localizedDescription
</code></pre>
<h3 id='a_20283-01' class='heading'>A_20283-01</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-201-code-decrypt-fails-if-wrong-aes-key' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:201</code>:  Decrypt, fails if wrong aes key</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19938-01,A_20283-01] Decrypt, fails if wrong aes key
guard let decrypted = try? token.decrypted(with: self.cryptoBox.aesKey) else {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-222-code-usage' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:222</code>:  Usage</h4>
<pre class="highlight plaintext"><code>accessToken: decrypted.accessToken, // [REQ:gemSpec_IDP_Frontend:A_20283-01] Usage
expires: self.time().addingTimeInterval(TimeInterval(token.expiresIn)),
</code></pre>
<h3 id='a_20309' class='heading'>A_20309</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-597-code-generation-and-hashing-for-codechallenge' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:597</code>:  generation and hashing for codeChallenge</h4>
<pre class="highlight plaintext"><code>// Generate a verifierCode
// [REQ:gemSpec_IDP_Frontend:A_20309] generation and hashing for codeChallenge
guard let verifierCode = try? self.cryptoBox.generateRandomVerifier(),
</code></pre>
<h4 id='code-sources-idp-internal-idpcrypto-swift-63-code-verifierlength-is-32-bytes-encoded-to-base64-this-results-in-43-chars' class='heading'><code>../Sources/IDP/internal/IDPCrypto.swift:63</code>:  verifierLength is 32 bytes, encoded to base64 this results in 43 chars</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20309] verifierLength is 32 bytes, encoded to base64 this results in 43 chars
// (32 * 4 / 3 = 42,6)
try randomGenerator(verifierLength).encodeBase64urlsafe().utf8string
</code></pre>
<h3 id='a_20483' class='heading'>A_20483</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-605-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:605</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20483]
return self.client.requestChallenge(
</code></pre>
<h3 id='a_20499' class='heading'>A_20499</h3>
<h4 id='code-doc-manual-requirement-notes-md-17-code-not-applicable-as-authenticator-modul-is-within-fdv-not-3rd-party-app' class='heading'><code>../doc/manual/requirement-notes.md:17</code>:  Not applicable as authenticator modul is within FdV, not 3rd party app.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20499] Not applicable as authenticator modul is within FdV, not 3rd party app.
</code></pre>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-244-code-deletion-of-sso_token-id_token-auth_token' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:244</code>:  Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499,A_20499-1#3] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_eRp_FdV:A_20186] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
set(can: nil)
</code></pre>
<h4 id='code-sources-erpapp-session-profilesecuredatawiper-swift-38-code-deletion-of-sso_token-id_token-auth_token' class='heading'><code>../Sources/eRpApp/Session/ProfileSecureDataWiper.swift:38</code>:  Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499,A_20499-01#2] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_eRp_FdV:A_20186] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_IDP_Frontend:A_21603] Certificate
storage.wipe()
</code></pre>
<h3 id='a_20499-01' class='heading'>A_20499-01</h3>
<h4 id='code-sources-erpapp-screens-settings-profiles-edit-editprofiledomain-swift-276-code-call-the-sso_token-removal-upon-manual-logout' class='heading'><code>../Sources/eRpApp/Screens/Settings/Profiles/Edit/EditProfileDomain.swift:276</code>:  Call the SSO_TOKEN removal upon manual logout</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499-01#1] Call the SSO_TOKEN removal upon manual logout
return profileSecureDataWiper.wipeSecureData(of: state.profileId).fireAndForget()
</code></pre>
<h4 id='code-sources-erpapp-session-profilesecuredatawiper-swift-38-code-deletion-of-sso_token-id_token-auth_token' class='heading'><code>../Sources/eRpApp/Session/ProfileSecureDataWiper.swift:38</code>:  Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499,A_20499-01#2] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_eRp_FdV:A_20186] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_IDP_Frontend:A_21603] Certificate
storage.wipe()
</code></pre>
<h3 id='a_20499-1' class='heading'>A_20499-1</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-244-code-deletion-of-sso_token-id_token-auth_token' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:244</code>:  Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499,A_20499-1#3] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_eRp_FdV:A_20186] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
set(can: nil)
</code></pre>
<h3 id='a_20512' class='heading'>A_20512</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-272-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:272</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20512]
self.storage.set(discovery: nil)
</code></pre>
<h4 id='code-sources-idp-models-discoverydocument-swift-166-code' class='heading'><code>../Sources/IDP/Models/DiscoveryDocument.swift:166</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20512]
func isValid(on date: Date) -&gt; Bool {
</code></pre>
<h3 id='a_20525' class='heading'>A_20525</h3>
<h4 id='code-doc-manual-requirement-notes-md-15-code-not-applicable-as-authenticator-modul-is-within-fdv-not-3rd-party-app' class='heading'><code>../doc/manual/requirement-notes.md:15</code>:  Not applicable as authenticator modul is within FdV, not 3rd party app</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20525] Not applicable as authenticator modul is within FdV, not 3rd party app
</code></pre>
<h4 id='code-doc-manual-requirement-notes-md-18-code-not-applicable-as-authenticator-modul-is-within-fdv-consent-is-given-by-using-the-app' class='heading'><code>../doc/manual/requirement-notes.md:18</code>:  Not applicable as authenticator modul is within FdV. Consent is given by using the app.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20525] Not applicable as authenticator modul is within FdV. Consent is given by using the app.
</code></pre>
<h3 id='a_20526-01' class='heading'>A_20526-01</h3>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-swift-377-code-sign-and-verify-with-idp' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.swift:377</code>:  sign and verify with idp</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20172]
// [REQ:gemSpec_IDP_Frontend:A_20526-01] sign and verify with idp
func signChallengeWithNFCCard(can: String,
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-swift-406-code-verify-with-idp' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.swift:406</code>:  verify with idp</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20172]
// [REQ:gemSpec_IDP_Frontend:A_20526-01] verify with idp
private func verifyResultWithIDP(_ signedChallenge: SignedChallenge,
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-319-code-sign' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:319</code>:  sign</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20526-01] sign
// [REQ:gemF_Tokenverschlüsselung:A_20700-06] sign
func sign(can: String, pin: String, challenge: IDPChallengeSession)
</code></pre>
<h3 id='a_20527' class='heading'>A_20527</h3>
<h4 id='code-doc-manual-requirement-notes-md-16-code-not-directly-applicable-as-authenticator-modul-is-within-fdv-not-3rd-party-app-authorization_code-will-be-used-directly' class='heading'><code>../doc/manual/requirement-notes.md:16</code>:  Not directly applicable as authenticator modul is within FdV, not 3rd party app. AUTHORIZATION_CODE will be used directly.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20527] Not directly applicable as authenticator modul is within FdV, not 3rd party app. AUTHORIZATION_CODE will be used directly.
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-164-code-returning-the-authorization_code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:164</code>:  Returning the AUTHORIZATION_CODE</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20527] Returning the AUTHORIZATION_CODE
return Just(exchangeToken).setFailureType(to: IDPError.self).eraseToAnyPublisher()
</code></pre>
<h3 id='a_20529-01' class='heading'>A_20529-01</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-182-code-encryption' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:182</code>:  Encryption</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20529-01] Encryption
// [REQ:gemSpec_IDP_Frontend:A_21323] Crypto box contains `Token-Key`
guard let encryptedKeyVerifier = try? KeyVerifier(
</code></pre>
<h3 id='a_20600' class='heading'>A_20600</h3>
<h4 id='code-sources-idp-internal-realidpclient-swift-173-code' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:173</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20600]
return IDPExchangeToken(
</code></pre>
<h4 id='code-sources-idp-internal-realidpclient-swift-484-code' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:484</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20600]
return IDPExchangeToken(code: code,
</code></pre>
<h3 id='a_20601' class='heading'>A_20601</h3>
<h4 id='code-sources-idp-internal-realidpclient-swift-101-code-transfer' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:101</code>:  Transfer</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20603,A_20601,A_20601-01] Transfer
URLQueryItem(name: "client_id", value: clientConfig.clientId.urlPercentEscapedString()),
</code></pre>
<h3 id='a_20601-01' class='heading'>A_20601-01</h3>
<h4 id='code-sources-idp-internal-realidpclient-swift-101-code-transfer' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:101</code>:  Transfer</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20603,A_20601,A_20601-01] Transfer
URLQueryItem(name: "client_id", value: clientConfig.clientId.urlPercentEscapedString()),
</code></pre>
<h3 id='a_20602' class='heading'>A_20602</h3>
<h4 id='code-sources-idp-idpinterceptor-swift-56-code' class='heading'><code>../Sources/IDP/IDPInterceptor.swift:56</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20602]
request.setValue("\(token.tokenType) \(token.accessToken)", forHTTPHeaderField: "Authorization")
</code></pre>
<h3 id='a_20603' class='heading'>A_20603</h3>
<h4 id='code-sources-idp-internal-realidpclient-swift-101-code-transfer' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:101</code>:  Transfer</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20603,A_20601,A_20601-01] Transfer
URLQueryItem(name: "client_id", value: clientConfig.clientId.urlPercentEscapedString()),
</code></pre>
<h4 id='code-sources-idp-internal-realidpclient-swift-249-code-transfer' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:249</code>:  transfer</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20603] transfer
"client_id": clientConfig.clientId,
</code></pre>
<h4 id='code-sources-erpapp-appconfiguration-swift-15-code-actual-id' class='heading'><code>../Sources/eRpApp/AppConfiguration.swift:15</code>:  Actual ID</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20603] Actual ID
private static let defaultClientId: String = "eRezeptApp"
</code></pre>
<h4 id='code-sources-erpapp-appconfiguration-swift-59-code-actual-id' class='heading'><code>../Sources/eRpApp/AppConfiguration.swift:59</code>:  Actual ID</h4>
<pre class="highlight plaintext"><code>// clientId
// [REQ:gemSpec_IDP_Frontend:A_20603] Actual ID
let clientId: String = defaultClientId
</code></pre>
<h3 id='a_20605' class='heading'>A_20605</h3>
<h4 id='code-sources-idp-models-idperror-swift-85-code-error-formatting' class='heading'><code>../Sources/IDP/Models/IDPError.swift:85</code>:  Error formatting</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605,A_20085] Error formatting
public var description: String {
</code></pre>
<h4 id='code-sources-idp-internal-realidpclient-swift-499-code-decoding-server-errors' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:499</code>:  Decoding server errors</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605] Decoding server errors
private static func responseError(for body: Data) -&gt; IDPError {
</code></pre>
<h4 id='code-sources-erpapp-common-errorlocalization-idperror-localization-swift-23-code-localized-description-of-server-errors' class='heading'><code>../Sources/eRpApp/Common/ErrorLocalization/IDPError+Localization.swift:23</code>:  Localized description of server errors</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_19937,A_20605,A_20085] Localized description of server errors
case let .internal(error: error): return error.localizedDescription
</code></pre>
<h3 id='a_20606' class='heading'>A_20606</h3>
<h4 id='code-sources-httpclient-defaulthttpclient-swift-38-code-live-urls-not-present-in-nsapptransportsecurity-exception-list-for-allowed' class='heading'><code>../Sources/HTTPClient/DefaultHTTPClient.swift:38</code>:  Live URLs not present in NSAppTransportSecurity exception list for allowed</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4385,A_18467,A_18464,GS-A_4387]
// [REQ:gemSpec_Krypt:GS-A_5322] TODO: Check if limiting SSL Sessions is possible, check for renegotiation
// swiftlint:disable:previous todo
// [REQ:gemSpec_IDP_Frontend:A_20606] Live URLs not present in NSAppTransportSecurity exception list for allowed
// HTTP communication
// [REQ:gemSpec_eRp_FdV:A_20206]

</code></pre>
<h3 id='a_20607' class='heading'>A_20607</h3>
<h4 id='code-doc-manual-requirement-notes-md-2-code-no-exceptions-set-in-nsapptransportsecurity-http-via-tls-is-enforced-os-will-use-system-root-certificates-in-combination-with-set-pinned-certificates-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:2</code>:  no exceptions set in NSAppTransportSecurity, HTTP via TLS is enforced; OS will use system root certificates in combination with set pinned certificates. see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20607,A_20609,A_20618] no exceptions set in NSAppTransportSecurity, HTTP via TLS is enforced; OS will use system root certificates in combination with set pinned certificates. see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h3 id='a_20608' class='heading'>A_20608</h3>
<h4 id='code-doc-manual-requirement-notes-md-25-code-implemented-with-ats-within-code-info-plist-code-path-code-nsapptransportsecurity-nspinneddomains-code' class='heading'><code>../doc/manual/requirement-notes.md:25</code>: : Implemented with ATS within <code>Info.plist</code>, path: <code>NSAppTransportSecurity.NSPinnedDomains</code></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20608,A_20608-01,A_20609,A_20618,A_20068-01]: Implemented with ATS within `Info.plist`, path: `NSAppTransportSecurity.NSPinnedDomains`
</code></pre>
<h3 id='a_20608-01' class='heading'>A_20608-01</h3>
<h4 id='code-doc-manual-requirement-notes-md-25-code-implemented-with-ats-within-code-info-plist-code-path-code-nsapptransportsecurity-nspinneddomains-code' class='heading'><code>../doc/manual/requirement-notes.md:25</code>: : Implemented with ATS within <code>Info.plist</code>, path: <code>NSAppTransportSecurity.NSPinnedDomains</code></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20608,A_20608-01,A_20609,A_20618,A_20068-01]: Implemented with ATS within `Info.plist`, path: `NSAppTransportSecurity.NSPinnedDomains`
</code></pre>
<h3 id='a_20609' class='heading'>A_20609</h3>
<h4 id='code-doc-manual-requirement-notes-md-2-code-no-exceptions-set-in-nsapptransportsecurity-http-via-tls-is-enforced-os-will-use-system-root-certificates-in-combination-with-set-pinned-certificates-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:2</code>:  no exceptions set in NSAppTransportSecurity, HTTP via TLS is enforced; OS will use system root certificates in combination with set pinned certificates. see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20607,A_20609,A_20618] no exceptions set in NSAppTransportSecurity, HTTP via TLS is enforced; OS will use system root certificates in combination with set pinned certificates. see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h4 id='code-doc-manual-requirement-notes-md-25-code-implemented-with-ats-within-code-info-plist-code-path-code-nsapptransportsecurity-nspinneddomains-code' class='heading'><code>../doc/manual/requirement-notes.md:25</code>: : Implemented with ATS within <code>Info.plist</code>, path: <code>NSAppTransportSecurity.NSPinnedDomains</code></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20608,A_20608-01,A_20609,A_20618,A_20068-01]: Implemented with ATS within `Info.plist`, path: `NSAppTransportSecurity.NSPinnedDomains`
</code></pre>
<h3 id='a_20614' class='heading'>A_20614</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-260-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:260</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20617-01,A_20623,A_20614]
.validateOrNil(with: trustStoreSession, timeProvider: time)
</code></pre>
<h3 id='a_20617-01' class='heading'>A_20617-01</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-260-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:260</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20617-01,A_20623,A_20614]
.validateOrNil(with: trustStoreSession, timeProvider: time)
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-291-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:291</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20617-01,A_20623]
.validate(with: self.trustStoreSession, timeProvider: self.time)
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-681-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:681</code>:</h4>
<pre class="highlight plaintext"><code>/// Returns a Publisher that validates the input streams discoveryDocument against the given trustStoreSession. If
/// the validity cannot be verified, the publisher fails with an `IDPError.trustStore` error.
///
/// [REQ:gemSpec_IDP_Frontend:A_20617-01]
/// [REQ:gemSpec_IDP_Frontend:A_20623]
///
/// - Parameter trustStoreSession: `TrustStoreSession` that is used to check the validity and trust of the
/// discoveryDocument.
/// - Returns: An AnyPublisher of `DiscoveryDocument`and `IDPError`
func validate(with trustStoreSession: TrustStoreSession,
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-713-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:713</code>:</h4>
<pre class="highlight plaintext"><code>/// Returns a Publisher that validates the input streams discoveryDocument and returns nil if validity cannot be
/// checked. All Errors are caught and result in an empty discoveryDocument.
///
/// [REQ:gemSpec_IDP_Frontend:A_20617-01,A_20623]
///
/// - Parameters:
///   - trustStoreSession: `TrustStoreSession` that is used to check the validity and trust of the disoveryDocument.
///   - time: Time provider to check the discovery document against.
/// - Returns: An AnyPublisher of `DiscoveryDocument`and `Never`.
func validateOrNil(with trustStoreSession: TrustStoreSession,
</code></pre>
<h3 id='a_20618' class='heading'>A_20618</h3>
<h4 id='code-doc-manual-requirement-notes-md-2-code-no-exceptions-set-in-nsapptransportsecurity-http-via-tls-is-enforced-os-will-use-system-root-certificates-in-combination-with-set-pinned-certificates-see-also-a-href-https-developer-apple-com-library-archive-documentation-general-reference-infoplistkeyreference-articles-cocoakeys-html-requirements-for-connecting-using-ats-a' class='heading'><code>../doc/manual/requirement-notes.md:2</code>:  no exceptions set in NSAppTransportSecurity, HTTP via TLS is enforced; OS will use system root certificates in combination with set pinned certificates. see also: <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html">Requirements for Connecting Using ATS</a></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20607,A_20609,A_20618] no exceptions set in NSAppTransportSecurity, HTTP via TLS is enforced; OS will use system root certificates in combination with set pinned certificates. see also: [Requirements for Connecting Using ATS](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
</code></pre>
<h4 id='code-doc-manual-requirement-notes-md-25-code-implemented-with-ats-within-code-info-plist-code-path-code-nsapptransportsecurity-nspinneddomains-code' class='heading'><code>../doc/manual/requirement-notes.md:25</code>: : Implemented with ATS within <code>Info.plist</code>, path: <code>NSAppTransportSecurity.NSPinnedDomains</code></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20608,A_20608-01,A_20609,A_20618,A_20068-01]: Implemented with ATS within `Info.plist`, path: `NSAppTransportSecurity.NSPinnedDomains`
</code></pre>
<h3 id='a_20623' class='heading'>A_20623</h3>
<h4 id='code-sources-truststore-x509truststore-swift-193-code-idp-oid' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:193</code>:  IDP oid</h4>
<pre class="highlight plaintext"><code>case oidErpVau // 1.2.276.0.76.4.258 == 0x06082A8214004C048202
// [REQ:gemSpec_IDP_Frontend:A_20623] IDP oid
case oidIdpd // 1.2.276.0.76.4.260 == 0x06082A8214004C048204
}
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-291-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:291</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20617-01,A_20623]
.validate(with: self.trustStoreSession, timeProvider: self.time)
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-682-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:682</code>:</h4>
<pre class="highlight plaintext"><code>/// Returns a Publisher that validates the input streams discoveryDocument against the given trustStoreSession. If
/// the validity cannot be verified, the publisher fails with an `IDPError.trustStore` error.
///
/// [REQ:gemSpec_IDP_Frontend:A_20617-01]
/// [REQ:gemSpec_IDP_Frontend:A_20623]
///
/// - Parameter trustStoreSession: `TrustStoreSession` that is used to check the validity and trust of the
/// discoveryDocument.
/// - Returns: An AnyPublisher of `DiscoveryDocument`and `IDPError`
func validate(with trustStoreSession: TrustStoreSession,
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-685-code-validation-call' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:685</code>:  Validation call</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20623] Validation call
return trustStoreSession.validate(discoveryDocument: document)
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-713-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:713</code>:</h4>
<pre class="highlight plaintext"><code>/// Returns a Publisher that validates the input streams discoveryDocument and returns nil if validity cannot be
/// checked. All Errors are caught and result in an empty discoveryDocument.
///
/// [REQ:gemSpec_IDP_Frontend:A_20617-01,A_20623]
///
/// - Parameters:
///   - trustStoreSession: `TrustStoreSession` that is used to check the validity and trust of the disoveryDocument.
///   - time: Time provider to check the discovery document against.
/// - Returns: An AnyPublisher of `DiscoveryDocument`and `Never`.
func validateOrNil(with trustStoreSession: TrustStoreSession,
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-743-code-validation' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:743</code>:  Validation</h4>
<pre class="highlight plaintext"><code>/// Returns a publisher that checks a discoveryDocument against the trust store. The Stream contains an output
/// boolean for the plain check or an TrustStoreError in case the TrustStoreSession sub streams failed.
///
/// [REQ:gemSpec_IDP_Frontend:A_20623] Validation
///
/// - Parameter discoveryDocument: The DiscoveryDocument that needs to be checked.
/// - Returns: A publisher that contains an output with the check value or an failure if the check failed
/// due to an underlying error.
func validate(discoveryDocument: DiscoveryDocument) -&gt; AnyPublisher&lt;Bool, TrustStoreError&gt; {
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-179-code-oid-check' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:179</code>:  oid check</h4>
<pre class="highlight plaintext"><code>} else if eeCert.contains(oidBytes: .oidIdpd) { // [REQ:gemSpec_IDP_Frontend:A_20623] oid check
return (vauCerts, idpCerts + [eeCert])
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-260-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:260</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20617-01,A_20623,A_20614]
.validateOrNil(with: trustStoreSession, timeProvider: time)
</code></pre>
<h3 id='a_20625' class='heading'>A_20625</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-208-code-validate-id_token-signature' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:208</code>:  Validate ID_TOKEN signature</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20625] Validate ID_TOKEN signature
guard let jwt = try? JWT(from: decrypted.idToken),
</code></pre>
<h3 id='a_20700-05' class='heading'>A_20700-05</h3>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-25-code-sign-with-c-ch-aut' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:25</code>:  sign with C.CH.AUT</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-05,A_20700-07] sign with C.CH.AUT
return challengeSession.sign(
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-435-code-sign-with-c-ch-aut' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:435</code>:  sign with C.CH.AUT</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-05,A_20700-07] sign with C.CH.AUT
return session.sign(
</code></pre>
<h3 id='a_20700-07' class='heading'>A_20700-07</h3>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-127-code-biometrics-only-other-modes-currently-not-supported' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:127</code>:  Biometrics only, other modes currently not supported</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] Biometrics only, other modes currently not supported
amr: [
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-25-code-sign-with-c-ch-aut' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:25</code>:  sign with C.CH.AUT</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-05,A_20700-07] sign with C.CH.AUT
return challengeSession.sign(
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-137-code-c-ch-aut' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:137</code>:  C.CH.AUT</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] C.CH.AUT
// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Smartcard signature
// [REQ:gemF_Tokenverschlüsselung:A_20700-05,A_20700-06] sign
.sign(challengeSession: challengeSession)
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-425-code-c-ch-aut' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:425</code>:  C.CH.AUT</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] C.CH.AUT
// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Smartcard signature
// [REQ:gemF_Tokenverschlüsselung:A_20700-06] sign
.readAutCertificate()
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-435-code-sign-with-c-ch-aut' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:435</code>:  sign with C.CH.AUT</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-05,A_20700-07] sign with C.CH.AUT
return session.sign(
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-466-code-perform-signature-with-openhealthcardkit' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:466</code>:  perform signature with OpenHealthCardKit</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] perform signature with OpenHealthCardKit
card.sign(data: message)
</code></pre>
<h3 id='a_20740' class='heading'>A_20740</h3>
<h4 id='code-sources-idp-internal-realidpclient-swift-110-code-transfer' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:110</code>:  transfer</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20740] transfer
name: "redirect_uri",
</code></pre>
<h4 id='code-sources-idp-internal-realidpclient-swift-246-code-transfer' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:246</code>:  transfer</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20740] transfer
"redirect_uri": redirectURI ?? clientConfig.redirectURI.absoluteString,
</code></pre>
<h4 id='code-sources-erpapp-appconfiguration-swift-61-code-actual-redirect-uri' class='heading'><code>../Sources/eRpApp/AppConfiguration.swift:61</code>:  Actual redirect uri</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20740] Actual redirect uri
let redirectUri = URL(string: "https://redirect.gematik.de/erezept")! // swiftlint:disable:this force_unwrapping
let extAuthRedirectUri = URL(
</code></pre>
<h3 id='a_20741' class='heading'>A_20741</h3>
<h4 id='code-doc-manual-requirement-notes-md-8-code-configuration-within-code-app-configuration-json-code-organisational-process-as-in-a_20603' class='heading'><code>../doc/manual/requirement-notes.md:8</code>:  Configuration within <code>app-configuration.json</code>, organisational process as in A_20603</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_20741] Configuration within `app-configuration.json`, organisational process as in A_20603
</code></pre>
<h3 id='a_21322' class='heading'>A_21322</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-18-code-storage-implementation-uses-ios-keychain' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:18</code>:  Storage implementation uses iOS Keychain</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19186]
// [REQ:gemSpec_eRp_FdV:A_19188] Deletion of data saved here is managed by the OS.
// [REQ:gemSpec_IDP_Frontend:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemF_Tokenverschlüsselung:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemSpec_IDP_Frontend:A_21595] Storage Implementation
class KeychainStorage: SecureUserDataStore, IDPStorage, SecureEGKCertificateStorage {
</code></pre>
<h3 id='a_21323' class='heading'>A_21323</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-183-code-crypto-box-contains-code-token-key-code' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:183</code>:  Crypto box contains <code>Token-Key</code></h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20529-01] Encryption
// [REQ:gemSpec_IDP_Frontend:A_21323] Crypto box contains `Token-Key`
guard let encryptedKeyVerifier = try? KeyVerifier(
</code></pre>
<h3 id='a_21414' class='heading'>A_21414</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-315-code-encrypt-access_token-when-requesting-the-pairing-endpoint' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:315</code>:  Encrypt ACCESS_TOKEN when requesting the pairing endpoint</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21414] Encrypt ACCESS_TOKEN when requesting the pairing endpoint
guard let tokenJWT = try? JWT(from: token.accessToken),
</code></pre>
<h3 id='a_21416' class='heading'>A_21416</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-309-code-encryption' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:309</code>:  Encryption</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_IDP_Frontend:A_21416] Encryption
guard let jwe = try? registrationData.encrypted(with: document.encryptionPublicKey,
</code></pre>
<h4 id='code-sources-idp-models-registrationdata-swift-14-code-data-structure' class='heading'><code>../Sources/IDP/Models/RegistrationData.swift:14</code>:  Data Structure</h4>
<pre class="highlight plaintext"><code>/// Bundles data needed for creating and verifiying a pairing.
/// [REQ:gemF_Biometrie:A_21415:Registration_Data]
/// [REQ:gemSpec_IDP_Frontend:A_21416] Data Structure
public struct RegistrationData: Claims, Codable {
</code></pre>
<h4 id='code-sources-idp-models-registrationdata-swift-105-code-encryption' class='heading'><code>../Sources/IDP/Models/RegistrationData.swift:105</code>:  Encryption</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemF_Biometrie:A_21415:Encrypted_Registration_Data] Returns JWE encrypted Registration_Data
/// [REQ:gemSpec_IDP_Frontend:A_21416] Encryption
func encrypted(with publicKey: BrainpoolP256r1.KeyExchange.PublicKey,
</code></pre>
<h3 id='a_21431' class='heading'>A_21431</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-389-code-encryption' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:389</code>:  Encryption</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_IDP_Frontend:A_21431] Encryption
guard let jwe = try? signedChallenge.encrypted(with: document.encryptionPublicKey,
</code></pre>
<h4 id='code-sources-idp-models-signedauthenticationdata-swift-33-code-exp-header' class='heading'><code>../Sources/IDP/Models/SignedAuthenticationData.swift:33</code>:  exp header</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_IDP_Frontend:A_21431] exp header
expiry: originalChallenge.challenge.exp,
</code></pre>
<h3 id='a_21443' class='heading'>A_21443</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-340-code-encrypt-access_token-when-requesting-the-unregister-endpoint' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:340</code>:  Encrypt ACCESS_TOKEN when requesting the unregister endpoint</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21443] Encrypt ACCESS_TOKEN when requesting the unregister endpoint
guard let tokenJWT = try? JWT(from: token.accessToken),
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-364-code-encrypt-access_token-when-requesting-the-list-endpoint' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:364</code>:  Encrypt ACCESS_TOKEN when requesting the list endpoint</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21443] Encrypt ACCESS_TOKEN when requesting the list endpoint
guard let tokenJWT = try? JWT(from: token.accessToken),
</code></pre>
<h3 id='a_21574' class='heading'>A_21574</h3>
<h4 id='code-sources-erpapp-screens-cardwall-login-cardwallloginoptiondomain-swift-106-code-present-user-information' class='heading'><code>../Sources/eRpApp/Screens/CardWall/Login/CardWallLoginOptionDomain.swift:106</code>:  Present user information</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21574] Present user information
return EffectTask(value: .presentSecurityWarning)
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-login-cardwallloginoptionview-swift-123-code-actual-view' class='heading'><code>../Sources/eRpApp/Screens/CardWall/Login/CardWallLoginOptionView.swift:123</code>:  Actual view</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21574] Actual view
struct PrivacyWarningViewContainer: View {
</code></pre>
<h3 id='a_21576' class='heading'>A_21576</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-333-code-deletion-call' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:333</code>:  deletion call</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21576] deletion call
public func unregisterDevice(_ keyIdentifier: String, token: IDPToken) -&gt; AnyPublisher&lt;Bool, IDPError&gt; {
</code></pre>
<h3 id='a_21578' class='heading'>A_21578</h3>
<h4 id='code-doc-manual-requirement-notes-md-19-code-ios-only-allows-biometric-access-via-secure-enclave-or-higher-order-apis' class='heading'><code>../doc/manual/requirement-notes.md:19</code>:  iOS only allows Biometric access via secure enclave or higher order apis.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_21578] iOS only allows Biometric access via secure enclave or higher order apis.
</code></pre>
<h4 id='code-sources-idp-privatekeycontainer-swift-140-code-enforced-via-access-attribute' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:140</code>:  Enforced via access attribute</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21578,A_21579,A_21580,A_21583] Enforced via access attribute
kSecAttrTokenID as String: kSecAttrTokenIDSecureEnclave,
</code></pre>
<h3 id='a_21579' class='heading'>A_21579</h3>
<h4 id='code-sources-idp-privatekeycontainer-swift-140-code-enforced-via-access-attribute' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:140</code>:  Enforced via access attribute</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21578,A_21579,A_21580,A_21583] Enforced via access attribute
kSecAttrTokenID as String: kSecAttrTokenIDSecureEnclave,
</code></pre>
<h3 id='a_21580' class='heading'>A_21580</h3>
<h4 id='code-sources-idp-privatekeycontainer-swift-140-code-enforced-via-access-attribute' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:140</code>:  Enforced via access attribute</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21578,A_21579,A_21580,A_21583] Enforced via access attribute
kSecAttrTokenID as String: kSecAttrTokenIDSecureEnclave,
</code></pre>
<h3 id='a_21581' class='heading'>A_21581</h3>
<h4 id='code-sources-idp-privatekeycontainer-swift-136-code-algorithm-selection' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:136</code>:  Algorithm selection</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21581,A_21589] Algorithm selection
kSecAttrKeyType as String: kSecAttrKeyTypeECSECPrimeRandom,
</code></pre>
<h3 id='a_21582' class='heading'>A_21582</h3>
<h4 id='code-sources-idp-privatekeycontainer-swift-125-code-method-selection' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:125</code>:  method selection</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21582] method selection
// [REQ:gemSpec_IDP_Frontend:A_21587] via `.privateKeyUsage`
[.privateKeyUsage,
</code></pre>
<h3 id='a_21583' class='heading'>A_21583</h3>
<h4 id='code-doc-manual-requirement-notes-md-20-code-secure-enclave-is-enforced-with-code-attributes' class='heading'><code>../doc/manual/requirement-notes.md:20</code>:  Secure Enclave is enforced with code attributes.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_21583] Secure Enclave is enforced with code attributes.
</code></pre>
<h4 id='code-sources-idp-privatekeycontainer-swift-140-code-enforced-via-access-attribute' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:140</code>:  Enforced via access attribute</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21578,A_21579,A_21580,A_21583] Enforced via access attribute
kSecAttrTokenID as String: kSecAttrTokenIDSecureEnclave,
</code></pre>
<h3 id='a_21584' class='heading'>A_21584</h3>
<h4 id='code-doc-manual-requirement-notes-md-21-code-there-is-no-api-to-allow-or-disallow-an-biometric-authentication-ios-is-handling-the-authorization-process-while-using-the-private-key-for-any-cryptographic-operation' class='heading'><code>../doc/manual/requirement-notes.md:21</code>:  There is no API to allow or disallow an biometric authentication, iOS is handling the authorization process while using the private key for any cryptographic operation.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_21584] There is no API to allow or disallow an biometric authentication, iOS is handling the authorization process while using the private key for any cryptographic operation.
</code></pre>
<h4 id='code-sources-idp-privatekeycontainer-swift-231-code-private-key-usage-triggers-biometric-unlock' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:231</code>:  private key usage triggers biometric unlock</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21584] private key usage triggers biometric unlock
guard let signature = SecKeyCreateSignature(privateKey,
</code></pre>
<h3 id='a_21585' class='heading'>A_21585</h3>
<h4 id='code-doc-manual-requirement-notes-md-22-code-default-behaviour-for-all-apps-when-using-private-access-group-a-href-https-developer-apple-com-documentation-security-keychain_services-keychain_items-sharing_access_to_keychain_items_among_a_collection_of_apps-https-developer-apple-com-documentation-security-keychain_services-keychain_items-sharing_access_to_keychain_items_among_a_collection_of_apps-a' class='heading'><code>../doc/manual/requirement-notes.md:22</code>:  Default behaviour for all apps when using private access group (<a href="https://developer.apple.com/documentation/security/keychain_services/keychain_items/sharing_access_to_keychain_items_among_a_collection_of_apps">https://developer.apple.com/documentation/security/keychain_services/keychain_items/sharing_access_to_keychain_items_among_a_collection_of_apps</a>)</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_21585] Default behaviour for all apps when using private access group (https://developer.apple.com/documentation/security/keychain_services/keychain_items/sharing_access_to_keychain_items_among_a_collection_of_apps)
</code></pre>
<h3 id='a_21586' class='heading'>A_21586</h3>
<h4 id='code-doc-manual-requirement-notes-md-23-code-ios-will-delete-all-user-related-data-after-user-accout-reset-key-chain-data-is-not-beeing-synced-with-icloud-since-code-ksecattrsynchronizable-code-is-not-applied' class='heading'><code>../doc/manual/requirement-notes.md:23</code>:  iOS will delete all user related data after user-accout reset. Key-Chain data is not beeing synced with iCloud since <code>kSecAttrSynchronizable</code> is not applied</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_21586] iOS will delete all user related data after user-accout reset. Key-Chain data is not beeing synced with iCloud since `kSecAttrSynchronizable` is not applied
</code></pre>
<h4 id='code-sources-idp-privatekeycontainer-swift-122-code-prevents-migration-to-other-devices' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:122</code>:  prevents migration to other devices</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21586] prevents migration to other devices
kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly,
</code></pre>
<h4 id='code-sources-idp-privatekeycontainer-swift-127-code-invalidates-biometry-after-changes' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:127</code>:  invalidates biometry after changes</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21586] invalidates biometry after changes
.biometryCurrentSet], &amp;error) else {
</code></pre>
<h3 id='a_21587' class='heading'>A_21587</h3>
<h4 id='code-sources-idp-privatekeycontainer-swift-126-code-via-code-privatekeyusage-code' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:126</code>:  via <code>.privateKeyUsage</code></h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21582] method selection
// [REQ:gemSpec_IDP_Frontend:A_21587] via `.privateKeyUsage`
[.privateKeyUsage,
</code></pre>
<h3 id='a_21588' class='heading'>A_21588</h3>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-13-code-key-identfier-generator-number-of-bytes-32' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:13</code>:  key identfier generator, number of bytes 32</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21588] key identfier generator, number of bytes 32
keyIdentifierGenerator: @escaping (() throws -&gt; Data) = { try generateSecureRandom(length: 32) },
</code></pre>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-36-code-key-generation' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:36</code>:  Key generation</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21588] Key generation
let keyIdentifier = try keyIdentifierGenerator()
</code></pre>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-101-code-usage-as-base64-encoded-string' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:101</code>:  usage as base64 encoded string</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21588] usage as base64 encoded string
guard let someIdentifier = identifier,
</code></pre>
<h3 id='a_21589' class='heading'>A_21589</h3>
<h4 id='code-sources-idp-privatekeycontainer-swift-136-code-algorithm-selection' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:136</code>:  Algorithm selection</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21581,A_21589] Algorithm selection
kSecAttrKeyType as String: kSecAttrKeyTypeECSECPrimeRandom,
</code></pre>
<h4 id='code-sources-idp-privatekeycontainer-swift-138-code-key-length' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:138</code>:  Key length</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21589] Key length
kSecAttrKeySizeInBits as String: 256,
</code></pre>
<h3 id='a_21590' class='heading'>A_21590</h3>
<h4 id='code-doc-manual-requirement-notes-md-24-code-references-of-code-secureenclavesignatureprovider-code-is-limited-to-registration-and-altverify-usage' class='heading'><code>../doc/manual/requirement-notes.md:24</code>:  References of <code>SecureEnclaveSignatureProvider</code> is limited to registration and altVerify usage.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_IDP_Frontend:A_21590] References of `SecureEnclaveSignatureProvider` is limited to registration and altVerify usage.
</code></pre>
<h4 id='code-sources-idp-privatekeycontainer-swift-17-code-this-is-the-container-to-represent-biometric-keys-usage-is-limited-to' class='heading'><code>../Sources/IDP/PrivateKeyContainer.swift:17</code>:  This is the container to represent biometric keys. Usage is limited to</h4>
<pre class="highlight plaintext"><code>/// Represents a (SecureEnclave) private key, namely `PrK_SE_AUT`, secured by iOS Biometrics.
///
/// [REQ:gemSpec_IDP_Frontend:A_21590] This is the container to represent biometric keys. Usage is limited to
/// authorization purposes
public struct PrivateKeyContainer {
</code></pre>
<h3 id='a_21591' class='heading'>A_21591</h3>
<h4 id='code-sources-idp-models-registrationdata-swift-57-code' class='heading'><code>../Sources/IDP/Models/RegistrationData.swift:57</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemF_Biometrie:A_21415:Device_Type]
/// [REQ:gemSpec_IDP_Frontend:A_21591]
public struct DeviceType: Codable {
</code></pre>
<h4 id='code-sources-idp-uidevice-extension-swift-10-code' class='heading'><code>../Sources/IDP/UIDevice+Extension.swift:10</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_IDP_Frontend:A_21591,A_21600]
func deviceInformation() -&gt; RegistrationData.DeviceInformation {
</code></pre>
<h4 id='code-sources-idp-uidevice-extension-swift-43-code' class='heading'><code>../Sources/IDP/UIDevice+Extension.swift:43</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_IDP_Frontend:A_21591,A_21600]
func deviceInformation() -&gt; RegistrationData.DeviceInformation {
</code></pre>
<h3 id='a_21595' class='heading'>A_21595</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-229-code-store-within-keychain' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:229</code>:  Store within keychain</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21595] Store within keychain
success = try keychainHelper.setGenericPassword(keyIdentifier, for: idpBiometricKeyIdentifier)
</code></pre>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-51-code-store-pairing-data' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:51</code>:  Store pairing data</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21598,A_21595,A_21595] Store pairing data
certificateStorage.set(certificate: certificate)
</code></pre>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-72-code-case-deletion' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:72</code>:  case deletion</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21595] case deletion
certificateStorage.set(certificate: nil)
</code></pre>
<h4 id='code-sources-idp-idpstorage-swift-12-code-storage-protocol' class='heading'><code>../Sources/IDP/IDPStorage.swift:12</code>:  Storage Protocol</h4>
<pre class="highlight plaintext"><code>/// Interface to access an eGK Certificate that should be kept private
/// [REQ:gemSpec_IDP_Frontend:A_21595] Storage Protocol
public protocol SecureEGKCertificateStorage {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-205-code-failure-will-delete-paring-data' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:205</code>:  Failure will delete paring data</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21598,A_21595] Failure will delete paring data
_ = try? signatureProvider.abort(pairingSession: pairingSession)
</code></pre>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-20-code-storage-implementation' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:20</code>:  Storage Implementation</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19186]
// [REQ:gemSpec_eRp_FdV:A_19188] Deletion of data saved here is managed by the OS.
// [REQ:gemSpec_IDP_Frontend:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemF_Tokenverschlüsselung:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemSpec_IDP_Frontend:A_21595] Storage Implementation
class KeychainStorage: SecureUserDataStore, IDPStorage, SecureEGKCertificateStorage {
</code></pre>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-202-code-store-within-keychain' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:202</code>:  Store within keychain</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21595] Store within keychain
_ = try? keychainHelper.setGenericPassword(derBytes, for: egkAuthCertIdentifier)
</code></pre>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-51-code-store-pairing-data' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:51</code>:  Store pairing data</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21598,A_21595,A_21595] Store pairing data
certificateStorage.set(certificate: certificate)
</code></pre>
<h3 id='a_21598' class='heading'>A_21598</h3>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-51-code-store-pairing-data' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:51</code>:  Store pairing data</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21598,A_21595,A_21595] Store pairing data
certificateStorage.set(certificate: certificate)
</code></pre>
<h4 id='code-sources-idp-defaultsecureenclavesignatureprovider-swift-69-code-delete-all-stored-keys-identifiers-certificate-in-case-of-an-unsuccessful' class='heading'><code>../Sources/IDP/DefaultSecureEnclaveSignatureProvider.swift:69</code>:  Delete all stored keys/identifiers/certificate in case of an unsuccessful</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21598] Delete all stored keys/identifiers/certificate in case of an unsuccessful
// registration
public func abort(pairingSession: PairingSession) throws {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-205-code-failure-will-delete-paring-data' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:205</code>:  Failure will delete paring data</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21598,A_21595] Failure will delete paring data
_ = try? signatureProvider.abort(pairingSession: pairingSession)
</code></pre>
<h3 id='a_21600' class='heading'>A_21600</h3>
<h4 id='code-sources-idp-uidevice-extension-swift-10-code' class='heading'><code>../Sources/IDP/UIDevice+Extension.swift:10</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_IDP_Frontend:A_21591,A_21600]
func deviceInformation() -&gt; RegistrationData.DeviceInformation {
</code></pre>
<h4 id='code-sources-idp-uidevice-extension-swift-43-code' class='heading'><code>../Sources/IDP/UIDevice+Extension.swift:43</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemSpec_IDP_Frontend:A_21591,A_21600]
func deviceInformation() -&gt; RegistrationData.DeviceInformation {
</code></pre>
<h3 id='a_21603' class='heading'>A_21603</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-248-code-certificate' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:248</code>:  Certificate</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21603] Certificate
set(certificate: nil)
</code></pre>
<h4 id='code-sources-erpapp-session-profilesecuredatawiper-swift-40-code-certificate' class='heading'><code>../Sources/eRpApp/Session/ProfileSecureDataWiper.swift:40</code>:  Certificate</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499,A_20499-01#2] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_eRp_FdV:A_20186] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_IDP_Frontend:A_21603] Certificate
storage.wipe()
</code></pre>
<h4 id='code-sources-erpapp-session-profilesecuredatawiper-swift-46-code-key-identifier' class='heading'><code>../Sources/eRpApp/Session/ProfileSecureDataWiper.swift:46</code>:  key identifier</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_21603] key identifier
storage.set(keyIdentifier: nil)
</code></pre>
<h4 id='code-sources-erpapp-session-profilesecuredatawiper-swift-50-code-prk_se_aut-puk_se_aut' class='heading'><code>../Sources/eRpApp/Session/ProfileSecureDataWiper.swift:50</code>:  PrK_SE_AUT/PuK_SE_AUT</h4>
<pre class="highlight plaintext"><code>// If deletion fails we cannot do anything
// [REQ:gemSpec_IDP_Frontend:A_21603] PrK_SE_AUT/PuK_SE_AUT
_ = try? PrivateKeyContainer.deleteExistingKey(for: identifier)
</code></pre>
<h2 id='gemspec_erp_fdv' class='heading'>gemSpec_eRp_FdV</h2>
<h3 id='a_19086' class='heading'>A_19086</h3>
<h4 id='code-doc-manual-requirement-notes-md-27-code-tracking-is-only-implemented-for-the-purpose-of-usability-tracking-sessions-are-not-persisted-session-ids-are-recreated-each-app-startup' class='heading'><code>../doc/manual/requirement-notes.md:27</code>:  Tracking is only implemented for the purpose of Usability-Tracking. Sessions are not persisted, session ids are recreated each app startup.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_19086,A_19087#1] Tracking is only implemented for the purpose of Usability-Tracking. Sessions are not persisted, session ids are recreated each app startup.
</code></pre>
<h3 id='a_19087' class='heading'>A_19087</h3>
<h4 id='code-doc-manual-requirement-notes-md-27-code-tracking-is-only-implemented-for-the-purpose-of-usability-tracking-sessions-are-not-persisted-session-ids-are-recreated-each-app-startup' class='heading'><code>../doc/manual/requirement-notes.md:27</code>:  Tracking is only implemented for the purpose of Usability-Tracking. Sessions are not persisted, session ids are recreated each app startup.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_19086,A_19087#1] Tracking is only implemented for the purpose of Usability-Tracking. Sessions are not persisted, session ids are recreated each app startup.
</code></pre>
<h4 id='code-sources-erpapp-tracking-contentsquareanalyticsadapter-swift-13-code-implementation-of-the-opt-in-usability-tracker' class='heading'><code>../Sources/eRpApp/Tracking/ContentSquareAnalyticsAdapter.swift:13</code>:  Implementation of the opt-in usability-tracker.</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19087#2] Implementation of the opt-in usability-tracker.
final class ContentSquareAnalyticsAdapter: NSObject, Tracker {
</code></pre>
<h3 id='a_19088' class='heading'>A_19088</h3>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingdomain-swift-179-code-show-comply-route-to-display-analytics-usage-within' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingDomain.swift:179</code>:  Show comply route to display analytics usage within</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19088,A_19091#1,A_19092] Show comply route to display analytics usage within
// onboarding
case .showTrackingAlert:
</code></pre>
<h3 id='a_19089' class='heading'>A_19089</h3>
<h4 id='code-sources-erpapp-screens-settings-settingsview-swift-266-code-user-info-for-usage-tracking' class='heading'><code>../Sources/eRpApp/Screens/Settings/SettingsView.swift:266</code>:  User info for usage tracking</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19089] User info for usage tracking
Label(title: { Text(L10n.stgTrkTxtExplanation) }, icon: {})
</code></pre>
<h3 id='a_19090' class='heading'>A_19090</h3>
<h4 id='code-sources-erpapp-scenedelegate-swift-215-code-activate-after-optin-is-granted' class='heading'><code>../Sources/eRpApp/SceneDelegate.swift:215</code>:  activate after optIn is granted</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19090] activate after optIn is granted
tracker.stopTracking()
</code></pre>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingdomain-swift-183-code-user-confirms-the-opt-in-within-settings' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingDomain.swift:183</code>:  User confirms the opt in within settings</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19090,A_19091#2] User confirms the opt in within settings
case .allowTracking:
</code></pre>
<h4 id='code-sources-erpapp-screens-settings-settingsdomain-swift-204-code-user-confirms-the-opt-in-within-settings' class='heading'><code>../Sources/eRpApp/Screens/Settings/SettingsDomain.swift:204</code>:  User confirms the opt in within settings</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19090,A_19091#4] User confirms the opt in within settings
case .confirmedOptInTracking:
</code></pre>
<h4 id='code-sources-erpapp-tracking-contentsquareanalyticsadapter-swift-42-code-activate-after-optin-is-granted' class='heading'><code>../Sources/eRpApp/Tracking/ContentSquareAnalyticsAdapter.swift:42</code>:  activate after optIn is granted</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19090] activate after optIn is granted
Contentsquare.start()
</code></pre>
<h4 id='code-sources-erpapp-tracking-contentsquareanalyticsadapter-swift-60-code-activate-tracking-only-if-permitted' class='heading'><code>../Sources/eRpApp/Tracking/ContentSquareAnalyticsAdapter.swift:60</code>:  activate tracking only if permitted</h4>
<pre class="highlight plaintext"><code>/// Starts tracking and calls `optIn` if permission is granted by the user.
/// Calling this method after calling `resetSessionID()` will create a new `sessionID`
// [REQ:gemSpec_eRp_FdV:A_19090] activate tracking only if permitted
private func startIfPermitted() {
</code></pre>
<h3 id='a_19091' class='heading'>A_19091</h3>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingdomain-swift-179-code-show-comply-route-to-display-analytics-usage-within' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingDomain.swift:179</code>:  Show comply route to display analytics usage within</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19088,A_19091#1,A_19092] Show comply route to display analytics usage within
// onboarding
case .showTrackingAlert:
</code></pre>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingdomain-swift-183-code-user-confirms-the-opt-in-within-settings' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingDomain.swift:183</code>:  User confirms the opt in within settings</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19090,A_19091#2] User confirms the opt in within settings
case .allowTracking:
</code></pre>
<h4 id='code-sources-erpapp-screens-settings-settingsdomain-swift-196-code-show-comply-route-to-display-analytics-usage-within-settings' class='heading'><code>../Sources/eRpApp/Screens/Settings/SettingsDomain.swift:196</code>:  Show comply route to display analytics usage within settings</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19091#3] Show comply route to display analytics usage within settings
state.destination = .complyTracking
</code></pre>
<h4 id='code-sources-erpapp-screens-settings-settingsdomain-swift-204-code-user-confirms-the-opt-in-within-settings' class='heading'><code>../Sources/eRpApp/Screens/Settings/SettingsDomain.swift:204</code>:  User confirms the opt in within settings</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19090,A_19091#4] User confirms the opt in within settings
case .confirmedOptInTracking:
</code></pre>
<h3 id='a_19092' class='heading'>A_19092</h3>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingdomain-swift-179-code-show-comply-route-to-display-analytics-usage-within' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingDomain.swift:179</code>:  Show comply route to display analytics usage within</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19088,A_19091#1,A_19092] Show comply route to display analytics usage within
// onboarding
case .showTrackingAlert:
</code></pre>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingdomain-swift-187-code-user-may-choose-to-not-accept-analytics' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingDomain.swift:187</code>:  User may choose to not accept analytics</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19092] User may choose to not accept analytics
case .dismissAlert:
</code></pre>
<h3 id='a_19093' class='heading'>A_19093</h3>
<h4 id='code-doc-manual-requirement-notes-md-28-code-usage-tracking-is-called-very-sparse-and-boils-down-to-one-place-where-all-visited-screens-are-recorded-see-usage-of-code-dependency-tracker-code-for-all-cases-where-the-actual-analytics-framework-is-used' class='heading'><code>../doc/manual/requirement-notes.md:28</code>:  Usage Tracking is called very sparse and boils down to one place where all visited screens are recorded. See usage of <code>@Dependency(\.tracker)</code> for all cases where the actual analytics framework is used.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_19093#1,A_19094] Usage Tracking is called very sparse and boils down to one place where all visited screens are recorded. See usage of `@Dependency(\.tracker)` for all cases where the actual analytics framework is used.
</code></pre>
<h4 id='code-sources-erpapp-tracking-analyticsreducer-swift-37-code-very-sparse-usage-of-actual-tracking-boils-down-to-this-call-where' class='heading'><code>../Sources/eRpApp/Tracking/AnalyticsReducer.swift:37</code>:  Very sparse usage of actual tracking boils down to this call where</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19093#2] Very sparse usage of actual tracking boils down to this call where
// only displayed screens are tracked
tracker.track(screen: newRoute)
</code></pre>
<h3 id='a_19094' class='heading'>A_19094</h3>
<h4 id='code-doc-manual-requirement-notes-md-28-code-usage-tracking-is-called-very-sparse-and-boils-down-to-one-place-where-all-visited-screens-are-recorded-see-usage-of-code-dependency-tracker-code-for-all-cases-where-the-actual-analytics-framework-is-used' class='heading'><code>../doc/manual/requirement-notes.md:28</code>:  Usage Tracking is called very sparse and boils down to one place where all visited screens are recorded. See usage of <code>@Dependency(\.tracker)</code> for all cases where the actual analytics framework is used.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_19093#1,A_19094] Usage Tracking is called very sparse and boils down to one place where all visited screens are recorded. See usage of `@Dependency(\.tracker)` for all cases where the actual analytics framework is used.
</code></pre>
<h3 id='a_19095' class='heading'>A_19095</h3>
<h4 id='code-sources-erpapp-tracking-contentsquareanalyticsadapter-swift-72-code-resets-sessionid-so-that-on-next-app-start-a-new-sessionid-will-be-created' class='heading'><code>../Sources/eRpApp/Tracking/ContentSquareAnalyticsAdapter.swift:72</code>:  resets sessionID so that on next app start a new sessionID will be created</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19095] resets sessionID so that on next app start a new sessionID will be created
Contentsquare.optOut()
</code></pre>
<h3 id='a_19096' class='heading'>A_19096</h3>
<h4 id='code-sources-erpapp-tracking-contentsquareanalyticsadapter-swift-61-code-remove-existing-sessions-while-starting-the-framework' class='heading'><code>../Sources/eRpApp/Tracking/ContentSquareAnalyticsAdapter.swift:61</code>:  Remove existing sessions while starting the framework</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19096] Remove existing sessions while starting the framework
Contentsquare.start()
</code></pre>
<h3 id='a_19097' class='heading'>A_19097</h3>
<h4 id='code-sources-erpapp-screens-settings-settingsview-swift-244-code-toggle-within-settings-to-enable-and-disable-usage-tracking' class='heading'><code>../Sources/eRpApp/Screens/Settings/SettingsView.swift:244</code>:  Toggle within Settings to enable and disable usage tracking</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19097] Toggle within Settings to enable and disable usage tracking
Toggle(isOn: viewStore.binding(
</code></pre>
<h3 id='a_19177' class='heading'>A_19177</h3>
<h4 id='code-sources-erpapp-screens-settings-profiles-protocol-auditeventsview-swift-9-code-actual-button-to-open-the-audit-events' class='heading'><code>../Sources/eRpApp/Screens/Settings/Profiles/Protocol/AuditEventsView.swift:9</code>:  Actual Button to open the audit events</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19177#1] Actual Button to open the audit events
struct AuditEventsView: View {
</code></pre>
<h4 id='code-sources-erpapp-screens-settings-profiles-edit-editprofileview-swift-490-code-actual-button-to-open-the-audit-events' class='heading'><code>../Sources/eRpApp/Screens/Settings/Profiles/Edit/EditProfileView.swift:490</code>:  Actual Button to open the audit events</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19177#2] Actual Button to open the audit events
NavigationLink(
</code></pre>
<h3 id='a_19183' class='heading'>A_19183</h3>
<h4 id='code-doc-manual-requirement-notes-md-14-code-no-erp-fd-data-is-forwarded-to-other-systems-besides-erp-fd-itself' class='heading'><code>../doc/manual/requirement-notes.md:14</code>:  No eRp-FD Data is forwarded to other systems besides eRp-FD itself.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_19183] No eRp-FD Data is forwarded to other systems besides eRp-FD itself.
</code></pre>
<h3 id='a_19186' class='heading'>A_19186</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-16-code' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:16</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19186]
// [REQ:gemSpec_eRp_FdV:A_19188] Deletion of data saved here is managed by the OS.
// [REQ:gemSpec_IDP_Frontend:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemF_Tokenverschlüsselung:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemSpec_IDP_Frontend:A_21595] Storage Implementation
class KeychainStorage: SecureUserDataStore, IDPStorage, SecureEGKCertificateStorage {
</code></pre>
<h3 id='a_19187' class='heading'>A_19187</h3>
<h4 id='code-sources-vau-vauinterceptor-swift-37-code-vau-bearer-must-be-set-to-trigger-a-request' class='heading'><code>../Sources/VAU/VAUInterceptor.swift:37</code>:  VAU Bearer must be set to trigger a request</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19187] VAU Bearer must be set to trigger a request
return vauAccessTokenProvider.vauBearerToken
</code></pre>
<h3 id='a_19188' class='heading'>A_19188</h3>
<h4 id='code-doc-manual-requirement-notes-md-6-code-session-data-access_token-id_token-sso_token-can-is-saved-in-the-keychain-its-deletion-is-managed-by-the-os-the-key-chain-is-sandboxed-and-can-only-be-shared-with-other-apps-by-the-same-vendor-when-explicitly-set-all-other-mentioned-data-is-deleted' class='heading'><code>../doc/manual/requirement-notes.md:6</code>:  session data (ACCESS_TOKEN, ID_TOKEN, SSO_TOKEN, CAN) is saved in the keychain. Its deletion is managed by the OS. The key chain is sandboxed and can only be shared with other apps by the same vendor when explicitly set. All other mentioned data is deleted.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_19188] session data (ACCESS_TOKEN, ID_TOKEN, SSO_TOKEN, CAN) is saved in the keychain. Its deletion is managed by the OS. The key chain is sandboxed and can only be shared with other apps by the same vendor when explicitly set. All other mentioned data is deleted.
</code></pre>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-17-code-deletion-of-data-saved-here-is-managed-by-the-os' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:17</code>:  Deletion of data saved here is managed by the OS.</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19186]
// [REQ:gemSpec_eRp_FdV:A_19188] Deletion of data saved here is managed by the OS.
// [REQ:gemSpec_IDP_Frontend:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemF_Tokenverschlüsselung:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemSpec_IDP_Frontend:A_21595] Storage Implementation
class KeychainStorage: SecureUserDataStore, IDPStorage, SecureEGKCertificateStorage {
</code></pre>
<h3 id='a_19229' class='heading'>A_19229</h3>
<h4 id='code-doc-manual-requirement-notes-md-7-code-audit-events-will-be-deleted-when-the-referencing-task-is-deleted-cascading-relationship-quot-task-gt-audit-event-quot-is-defined-in-sources-erplocalstorage-prescriptions-erxtask-xcdatamodeld-erxtask-xcdatamodel-contents' class='heading'><code>../doc/manual/requirement-notes.md:7</code>:  Audit events will be deleted when the referencing task is deleted. Cascading relationship &ldquo;task -&gt; audit event&rdquo; is defined in Sources/eRpLocalStorage/Prescriptions/ErxTask.xcdatamodeld/ErxTask.xcdatamodel/contents</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_19229] Audit events will be deleted when the referencing task is deleted. Cascading relationship "task -&gt; audit event" is defined in Sources/eRpLocalStorage/Prescriptions/ErxTask.xcdatamodeld/ErxTask.xcdatamodel/contents
</code></pre>
<h4 id='code-sources-erpapp-screens-main-prescriptiondetail-prescriptiondetaildomain-swift-125-code' class='heading'><code>../Sources/eRpApp/Screens/Main/PrescriptionDetail/PrescriptionDetailDomain.swift:125</code>:</h4>
<pre class="highlight plaintext"><code>// Delete
// [REQ:gemSpec_eRp_FdV:A_19229]
case .delete:
</code></pre>
<h4 id='code-sources-erpapp-screens-main-prescriptiondetail-prescriptiondetaildomain-swift-132-code' class='heading'><code>../Sources/eRpApp/Screens/Main/PrescriptionDetail/PrescriptionDetailDomain.swift:132</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19229]
case .confirmedDelete:
</code></pre>
<h3 id='a_19739' class='heading'>A_19739</h3>
<h4 id='code-doc-manual-requirement-notes-md-26-code-implemented-with-ats-within-code-info-plist-code-path-code-nsapptransportsecurity-nspinneddomains-code' class='heading'><code>../doc/manual/requirement-notes.md:26</code>:  Implemented with ATS within <code>Info.plist</code>, path: <code>NSAppTransportSecurity.NSPinnedDomains</code></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_20033,A_19739] Implemented with ATS within `Info.plist`, path: `NSAppTransportSecurity.NSPinnedDomains`
</code></pre>
<h4 id='code-sources-truststore-truststoresession-swift-19-code' class='heading'><code>../Sources/TrustStore/TrustStoreSession.swift:19</code>:</h4>
<pre class="highlight plaintext"><code>/// Request and validate the VAU certificate
///
/// [REQ:gemSpec_eRp_FdV:A_19739]
///
/// - Returns: A publisher that emits a validated VAU certificate or an error
func loadVauCertificate() -&gt; AnyPublisher&lt;X509, TrustStoreError&gt;
</code></pre>
<h4 id='code-sources-truststore-truststoresession-swift-29-code' class='heading'><code>../Sources/TrustStore/TrustStoreSession.swift:29</code>:</h4>
<pre class="highlight plaintext"><code>/// Try to validate a given certificate against the underlying truststore.
/// An OCSP response will also be requested and checked against
///
/// [REQ:gemSpec_eRp_FdV:A_19739]
///
/// - Parameter certificate: the certificate to be validated
/// - Returns: A publisher that emits a Boolean stating whether or not the certificate could be validated.
func validate(certificate: X509) -&gt; AnyPublisher&lt;Bool, TrustStoreError&gt;
</code></pre>
<h3 id='a_19984' class='heading'>A_19984</h3>
<h4 id='code-sources-pharmacy-fhirclient-pharmacyoperation-swift-24-code-validate-pharmacy-data-format-conforming-to-fhir' class='heading'><code>../Sources/Pharmacy/FHIRClient+PharmacyOperation.swift:24</code>:  validate pharmacy data format conforming to FHIR</h4>
<pre class="highlight plaintext"><code>/// Convenience function for searching for pharmacies
///
/// [REQ:gemSpec_eRp_FdV:A_19984] validate pharmacy data format conforming to FHIR
///
/// - Parameters:
///   - searchTerm: Search term
///   - position: Pharmacy position (latitude and longitude)
/// - Returns: `AnyPublisher` that emits a list of `PharmacyLocation`s or is empty when not found
public func searchPharmacies(by searchTerm: String,
</code></pre>
<h4 id='code-sources-erpkit-scannederxtask-swift-48-code-parse-task-id-and-access-code' class='heading'><code>../Sources/eRpKit/ScannedErxTask.swift:48</code>:  parse task id and access code</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19984] parse task id and access code
guard let taskId = taskString.match(pattern: Self.taskIdRegex) else {
</code></pre>
<h4 id='code-sources-erpkit-scannederxtask-swift-102-code-validate-data-matrix-code-structure' class='heading'><code>../Sources/eRpKit/ScannedErxTask.swift:102</code>:  validate data matrix code structure</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19984] validate data matrix code structure
erxToken = try jsonDecoder.decode(ErxToken.self, from: jsonData)
</code></pre>
<h3 id='a_20032-01' class='heading'>A_20032-01</h3>
<h4 id='code-doc-manual-requirement-notes-md-4-code-note-grace-period-for-ocsp-responses-is-12h' class='heading'><code>../doc/manual/requirement-notes.md:4</code>:  Note: grace period for OCSP responses is 12h</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_20032-01] Note: grace period for OCSP responses is 12h
</code></pre>
<h4 id='code-sources-truststore-x509truststore-swift-14-code' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:14</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:A_21218]
// [REQ:gemSpec_eRp_FdV:A_20032-01]
// Category A: Cross root certificates
private let rootCa: X509
</code></pre>
<h3 id='a_20033' class='heading'>A_20033</h3>
<h4 id='code-doc-manual-requirement-notes-md-26-code-implemented-with-ats-within-code-info-plist-code-path-code-nsapptransportsecurity-nspinneddomains-code' class='heading'><code>../doc/manual/requirement-notes.md:26</code>:  Implemented with ATS within <code>Info.plist</code>, path: <code>NSAppTransportSecurity.NSPinnedDomains</code></h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_20033,A_19739] Implemented with ATS within `Info.plist`, path: `NSAppTransportSecurity.NSPinnedDomains`
</code></pre>
<h3 id='a_20167' class='heading'>A_20167</h3>
<h4 id='code-sources-idp-idpinterceptor-swift-61-code-no-token-available-bailout' class='heading'><code>../Sources/IDP/IDPInterceptor.swift:61</code>:  no token available, bailout</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20167] no token available, bailout
.authentication(error)
</code></pre>
<h4 id='code-sources-idp-idpinterceptor-swift-70-code-invalidate-delete-unauthorized-token' class='heading'><code>../Sources/IDP/IDPInterceptor.swift:70</code>:  invalidate/delete unauthorized token</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20167] invalidate/delete unauthorized token
self.session.invalidateAccessToken()
</code></pre>
<h4 id='code-sources-erpapp-data-prescriptionrepository-swift-133-code-no-token-not-authorized-show-authenticator-module' class='heading'><code>../Sources/eRpApp/Data/PrescriptionRepository.swift:133</code>:  no token/not authorized, show authenticator module</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20167,A_20172] no token/not authorized, show authenticator module
if Result.success(false) == isAuthenticated {
</code></pre>
<h4 id='code-sources-erpapp-screens-pharmacy-redeemservice-redeemservice-swift-144-code-no-token-not-authorized-show-authenticator-module' class='heading'><code>../Sources/eRpApp/Screens/Pharmacy/RedeemService/RedeemService.swift:144</code>:  no token/not authorized, show authenticator module</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20167,A_20172] no token/not authorized, show authenticator module
if Result.success(false) == authenticated {
</code></pre>
<h3 id='a_20172' class='heading'>A_20172</h3>
<h4 id='code-sources-erpapp-data-prescriptionrepository-swift-133-code-no-token-not-authorized-show-authenticator-module' class='heading'><code>../Sources/eRpApp/Data/PrescriptionRepository.swift:133</code>:  no token/not authorized, show authenticator module</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20167,A_20172] no token/not authorized, show authenticator module
if Result.success(false) == isAuthenticated {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-swift-355-code' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.swift:355</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20172]
func idpChallengePublisher(for profileID: UUID) -&gt; EffectTask&lt;CardWallReadCardDomain.Action&gt; {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-swift-376-code' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.swift:376</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20172]
// [REQ:gemSpec_IDP_Frontend:A_20526-01] sign and verify with idp
func signChallengeWithNFCCard(can: String,
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-swift-405-code' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.swift:405</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20172]
// [REQ:gemSpec_IDP_Frontend:A_20526-01] verify with idp
private func verifyResultWithIDP(_ signedChallenge: SignedChallenge,
</code></pre>
<h4 id='code-sources-erpapp-screens-pharmacy-redeemservice-redeemservice-swift-144-code-no-token-not-authorized-show-authenticator-module' class='heading'><code>../Sources/eRpApp/Screens/Pharmacy/RedeemService/RedeemService.swift:144</code>:  no token/not authorized, show authenticator module</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20167,A_20172] no token/not authorized, show authenticator module
if Result.success(false) == authenticated {
</code></pre>
<h3 id='a_20183' class='heading'>A_20183</h3>
<h4 id='code-sources-pharmacy-pharmacyfhirdatasource-swift-31-code' class='heading'><code>../Sources/Pharmacy/PharmacyFHIRDataSource.swift:31</code>:</h4>
<pre class="highlight plaintext"><code>/// API for requesting pharmacies with the passed search term
///
/// [REQ:gemSpec_eRp_FdV:A_20183]
///
/// - Parameter searchTerm: String that send to the server for filtering the pharmacies response
/// - Parameter position: Position (latitude and longitude) of pharmacy
/// - Parameter filter: further filter parameters for pharmacies
/// - Returns: `AnyPublisher` that emits all `PharmacyLocation`s for the given `searchTerm`
public func searchPharmacies(by searchTerm: String,
</code></pre>
<h4 id='code-sources-pharmacy-pharmacyremotedatastore-swift-22-code' class='heading'><code>../Sources/Pharmacy/PharmacyRemoteDataStore.swift:22</code>:</h4>
<pre class="highlight plaintext"><code>/// API for requesting pharmacies with the passed search term
///
/// [REQ:gemSpec_eRp_FdV:A_20183]
///
/// - Parameter searchTerm: String that send to the server for filtering the pharmacies response
/// - Parameter position: Position (latitude and longitude) of pharmacy
/// - Parameter filter: further filter parameters for pharmacies
/// - Returns: `AnyPublisher` that emits all `PharmacyLocation`s for the given `searchTerm`
func searchPharmacies(by searchTerm: String,
</code></pre>
<h4 id='code-sources-erpapp-screens-pharmacy-search-pharmacysearchdomain-swift-175-code-search-results-mirrored-verbatim-no-sorting-no-highlighting' class='heading'><code>../Sources/eRpApp/Screens/Pharmacy/Search/PharmacySearchDomain.swift:175</code>:  search results mirrored verbatim, no sorting, no highlighting</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20183] search results mirrored verbatim, no sorting, no highlighting
state.searchState = .searchRunning
</code></pre>
<h3 id='a_20184' class='heading'>A_20184</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-121-code' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:121</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20184]
let success: Bool
</code></pre>
<h4 id='code-sources-erpapp-session-standardsessioncontainer-swift-89-code-keychain-storage-encrypts-session-ssl-tokens' class='heading'><code>../Sources/eRpApp/Session/StandardSessionContainer.swift:89</code>:  Keychain storage encrypts session/ssl tokens</h4>
<pre class="highlight plaintext"><code>storage: secureUserStore, // [REQ:gemSpec_eRp_FdV:A_20184] Keychain storage encrypts session/ssl tokens
schedulers: schedulers,
</code></pre>
<h4 id='code-sources-erpapp-session-standardsessioncontainer-swift-107-code-no-persistent-storage-for-idp-biometrics-session' class='heading'><code>../Sources/eRpApp/Session/StandardSessionContainer.swift:107</code>:  No persistent storage for idp biometrics session</h4>
<pre class="highlight plaintext"><code>storage: MemoryStorage(), // [REQ:gemSpec_eRp_FdV:A_20184] No persistent storage for idp biometrics session
schedulers: schedulers,
</code></pre>
<h3 id='a_20185' class='heading'>A_20185</h3>
<h4 id='code-sources-erpapp-screens-settings-settingsdomain-swift-199-code-optout-for-user' class='heading'><code>../Sources/eRpApp/Screens/Settings/SettingsDomain.swift:199</code>:  OptOut for user</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20185,A_20187] OptOut for user
state.trackerOptIn = false
</code></pre>
<h3 id='a_20186' class='heading'>A_20186</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-245-code-deletion-of-sso_token-id_token-auth_token' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:245</code>:  Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499,A_20499-1#3] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_eRp_FdV:A_20186] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
set(can: nil)
</code></pre>
<h4 id='code-sources-erpapp-session-profilesecuredatawiper-swift-39-code-deletion-of-sso_token-id_token-auth_token' class='heading'><code>../Sources/eRpApp/Session/ProfileSecureDataWiper.swift:39</code>:  Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20499,A_20499-01#2] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_eRp_FdV:A_20186] Deletion of SSO_TOKEN, ID_TOKEN, AUTH_TOKEN
// [REQ:gemSpec_IDP_Frontend:A_21603] Certificate
storage.wipe()
</code></pre>
<h3 id='a_20187' class='heading'>A_20187</h3>
<h4 id='code-sources-erpapp-screens-settings-settingsdomain-swift-199-code-optout-for-user' class='heading'><code>../Sources/eRpApp/Screens/Settings/SettingsDomain.swift:199</code>:  OptOut for user</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20185,A_20187] OptOut for user
state.trackerOptIn = false
</code></pre>
<h3 id='a_20193' class='heading'>A_20193</h3>
<h4 id='code-doc-manual-requirement-notes-md-29-code-camera-is-only-used-for-scanning-recipes-and-avatar-setup-corelocation-is-used-for-pharmacy-search-usage-is-requested-before-actual-first-usage-the-user-is-asked-for-permission-this-is-also-enforced-by-the-os' class='heading'><code>../doc/manual/requirement-notes.md:29</code>:  Camera is only used for scanning recipes and avatar setup. CoreLocation is used for pharmacy search. Usage is requested before actual first usage, the user is asked for permission. This is also enforced by the OS.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_20193,A_20194] Camera is only used for scanning recipes and avatar setup. CoreLocation is used for pharmacy search. Usage is requested before actual first usage, the user is asked for permission. This is also enforced by the OS.
</code></pre>
<h3 id='a_20194' class='heading'>A_20194</h3>
<h4 id='code-doc-manual-requirement-notes-md-29-code-camera-is-only-used-for-scanning-recipes-and-avatar-setup-corelocation-is-used-for-pharmacy-search-usage-is-requested-before-actual-first-usage-the-user-is-asked-for-permission-this-is-also-enforced-by-the-os' class='heading'><code>../doc/manual/requirement-notes.md:29</code>:  Camera is only used for scanning recipes and avatar setup. CoreLocation is used for pharmacy search. Usage is requested before actual first usage, the user is asked for permission. This is also enforced by the OS.</h4>
<pre class="highlight plaintext"><code>[REQ:gemSpec_eRp_FdV:A_20193,A_20194] Camera is only used for scanning recipes and avatar setup. CoreLocation is used for pharmacy search. Usage is requested before actual first usage, the user is asked for permission. This is also enforced by the OS.
</code></pre>
<h3 id='a_20206' class='heading'>A_20206</h3>
<h4 id='code-sources-httpclient-defaulthttpclient-swift-40-code' class='heading'><code>../Sources/HTTPClient/DefaultHTTPClient.swift:40</code>:</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_Krypt:GS-A_4385,A_18467,A_18464,GS-A_4387]
// [REQ:gemSpec_Krypt:GS-A_5322] TODO: Check if limiting SSL Sessions is possible, check for renegotiation
// swiftlint:disable:previous todo
// [REQ:gemSpec_IDP_Frontend:A_20606] Live URLs not present in NSAppTransportSecurity exception list for allowed
// HTTP communication
// [REQ:gemSpec_eRp_FdV:A_20206]

</code></pre>
<h3 id='a_20208' class='heading'>A_20208</h3>
<h4 id='code-sources-pharmacy-pharmacyfhiroperation-swift-14-code' class='heading'><code>../Sources/Pharmacy/PharmacyFHIROperation.swift:14</code>:</h4>
<pre class="highlight plaintext"><code>/// Search for pharmacies by name
/// [REQ:gemSpec_eRp_FdV:A_20208]
case searchPharmacies(searchTerm: String, position: Position?, filter: [String: String], handler: Handler)
</code></pre>
<h3 id='a_20285' class='heading'>A_20285</h3>
<h4 id='code-sources-erpapp-screens-pharmacy-search-pharmacysearchdomain-swift-186-code-pharmacy-order-is-resolved-on-server-side' class='heading'><code>../Sources/eRpApp/Screens/Pharmacy/Search/PharmacySearchDomain.swift:186</code>:  pharmacy order is resolved on server side</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_20285] pharmacy order is resolved on server side
state.pharmacies = pharmacies.map {
</code></pre>
<h2 id='gemf_tokenverschlüsselung' class='heading'>gemF_Tokenverschlüsselung</h2>
<h3 id='a_20526-01' class='heading'>A_20526-01</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-151-code-encryption-with-jwe' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:151</code>:  Encryption with JWE</h4>
<pre class="highlight plaintext"><code>// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Encryption with JWE
guard let jwe = try? signedChallenge.encrypt(with: document.encryptionPublicKey,
</code></pre>
<h4 id='code-sources-idp-models-idpchallengesession-swift-86-code-embed-certificate' class='heading'><code>../Sources/IDP/Models/IDPChallengeSession.swift:86</code>:  Embed certificate</h4>
<pre class="highlight plaintext"><code>// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Embed certificate
let header = JWT.Header(alg: alg, x5c: certificates, typ: "JWT", cty: "NJWT")
</code></pre>
<h4 id='code-sources-idp-internal-realidpclient-swift-146-code-building-and-sending-the-request' class='heading'><code>../Sources/IDP/internal/RealIDPClient.swift:146</code>:  Building and sending the request</h4>
<pre class="highlight plaintext"><code>// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Building and sending the request
var request = URLRequest(url: document.authentication.url, cachePolicy: .reloadIgnoringCacheData)
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-138-code-smartcard-signature' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:138</code>:  Smartcard signature</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] C.CH.AUT
// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Smartcard signature
// [REQ:gemF_Tokenverschlüsselung:A_20700-05,A_20700-06] sign
.sign(challengeSession: challengeSession)
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-426-code-smartcard-signature' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:426</code>:  Smartcard signature</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] C.CH.AUT
// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Smartcard signature
// [REQ:gemF_Tokenverschlüsselung:A_20700-06] sign
.readAutCertificate()
</code></pre>
<h3 id='a_20700-05' class='heading'>A_20700-05</h3>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-139-code-sign' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:139</code>:  sign</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] C.CH.AUT
// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Smartcard signature
// [REQ:gemF_Tokenverschlüsselung:A_20700-05,A_20700-06] sign
.sign(challengeSession: challengeSession)
</code></pre>
<h3 id='a_20700-06' class='heading'>A_20700-06</h3>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-cardwallreadcarddomain-environment-biometrics-swift-139-code-sign' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/CardWallReadCardDomain.Environment+Biometrics.swift:139</code>:  sign</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] C.CH.AUT
// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Smartcard signature
// [REQ:gemF_Tokenverschlüsselung:A_20700-05,A_20700-06] sign
.sign(challengeSession: challengeSession)
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-320-code-sign' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:320</code>:  sign</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20526-01] sign
// [REQ:gemF_Tokenverschlüsselung:A_20700-06] sign
func sign(can: String, pin: String, challenge: IDPChallengeSession)
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-readcard-nfcsignatureprovider-swift-427-code-sign' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ReadCard/NFCSignatureProvider.swift:427</code>:  sign</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Frontend:A_20700-07] C.CH.AUT
// [REQ:gemF_Tokenverschlüsselung:A_20526-01] Smartcard signature
// [REQ:gemF_Tokenverschlüsselung:A_20700-06] sign
.readAutCertificate()
</code></pre>
<h3 id='a_21322' class='heading'>A_21322</h3>
<h4 id='code-sources-erpapp-session-keychainstorage-swift-19-code-storage-implementation-uses-ios-keychain' class='heading'><code>../Sources/eRpApp/Session/KeychainStorage.swift:19</code>:  Storage implementation uses iOS Keychain</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_FdV:A_19186]
// [REQ:gemSpec_eRp_FdV:A_19188] Deletion of data saved here is managed by the OS.
// [REQ:gemSpec_IDP_Frontend:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemF_Tokenverschlüsselung:A_21322] Storage implementation uses iOS Keychain
// [REQ:gemSpec_IDP_Frontend:A_21595] Storage Implementation
class KeychainStorage: SecureUserDataStore, IDPStorage, SecureEGKCertificateStorage {
</code></pre>
<h2 id='gemspec_idp_sek' class='heading'>gemSpec_IDP_Sek</h2>
<h3 id='a_22294' class='heading'>A_22294</h3>
<h4 id='code-sources-erpapp-screens-cardwall-extauth-cardwallextauthconfirmationdomain-swift-84-code-start-login-with-kk' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ExtAuth/CardWallExtAuthConfirmationDomain.swift:84</code>:  Start login with KK</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22294] Start login with KK
return environment.idpSession.startExtAuth(entry: state.selectedKK)
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-extauth-cardwallextauthselectiondomain-swift-119-code-select-kk' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ExtAuth/CardWallExtAuthSelectionDomain.swift:119</code>:  Select KK</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22294] Select KK
state.selectedKK = entry
</code></pre>
<h3 id='a_22295' class='heading'>A_22295</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-439-code-usage-of-kk_app_id' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:439</code>:  Usage of kk_app_id</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22295] Usage of kk_app_id
let extAuth = IDPExtAuth(kkAppId: entry.identifier,
</code></pre>
<h3 id='a_22296' class='heading'>A_22296</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-411-code-signature-verification' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:411</code>:  Signature verification</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22296] Signature verification
guard try jwtContainer.verify(with: document.discKey) == true else {
</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-extauth-cardwallextauthselectiondomain-swift-103-code-load-available-apps' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ExtAuth/CardWallExtAuthSelectionDomain.swift:103</code>:  Load available apps</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22296] Load available apps
return idpSession.loadDirectoryKKApps()
</code></pre>
<h3 id='a_22299' class='heading'>A_22299</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-452-code-remember-state-parameter-for-later-verification' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:452</code>:  Remember State parameter for later verification</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22299] Remember State parameter for later verification

</code></pre>
<h4 id='code-sources-erpapp-screens-cardwall-extauth-cardwallextauthconfirmationdomain-swift-96-code-follow-redirect' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ExtAuth/CardWallExtAuthConfirmationDomain.swift:96</code>:  Follow redirect</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22299] Follow redirect
guard environment.resourceHandler.canOpenURL(url) else {
</code></pre>
<h3 id='a_22301' class='heading'>A_22301</h3>
<h4 id='code-sources-idp-defaultidpsession-swift-483-code-match-request-with-existing-state' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:483</code>:  Match request with existing state</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22301] Match request with existing state
guard let challengeSession = extAuthRequestStorage.getExtAuthRequest(for: state) else {
</code></pre>
<h4 id='code-sources-idp-defaultidpsession-swift-492-code-send-authorization-request' class='heading'><code>../Sources/IDP/DefaultIDPSession.swift:492</code>:  Send authorization request</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22301] Send authorization request
return extAuthVerify(verify)
</code></pre>
<h3 id='a_22313' class='heading'>A_22313</h3>
<h4 id='code-sources-erpapp-screens-cardwall-extauth-cardwallextauthconfirmationdomain-swift-102-code-remember-state-parameter-for-later-verification' class='heading'><code>../Sources/eRpApp/Screens/CardWall/ExtAuth/CardWallExtAuthConfirmationDomain.swift:102</code>:  Remember State parameter for later verification</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_IDP_Sek:A_22313] Remember State parameter for later verification
environment.resourceHandler.open(url, options: [:]) { result in
</code></pre>
<h2 id='gemf_biometrie' class='heading'>gemF_Biometrie</h2>
<h3 id='a_21415' class='heading'>A_21415</h3>
<h4 id='pairing_data-code-sources-idp-models-pairingdata-swift-12-code' class='heading'>Pairing_Data <code>../Sources/IDP/Models/PairingData.swift:12</code>:</h4>
<pre class="highlight plaintext"><code>/// Structure for registering a biometric key. See `SignedPairingData` for sigend representation.
/// [REQ:gemF_Biometrie:A_21415:Pairing_Data]
public struct PairingData: Claims, Codable {
</code></pre>
<h4 id='registration_data-code-sources-idp-models-registrationdata-swift-13-code' class='heading'>Registration_Data <code>../Sources/IDP/Models/RegistrationData.swift:13</code>:</h4>
<pre class="highlight plaintext"><code>/// Bundles data needed for creating and verifiying a pairing.
/// [REQ:gemF_Biometrie:A_21415:Registration_Data]
/// [REQ:gemSpec_IDP_Frontend:A_21416] Data Structure
public struct RegistrationData: Claims, Codable {
</code></pre>
<h4 id='device_information-code-sources-idp-models-registrationdata-swift-39-code' class='heading'>Device_Information <code>../Sources/IDP/Models/RegistrationData.swift:39</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemF_Biometrie:A_21415:Device_Information]
public struct DeviceInformation: Codable {
</code></pre>
<h4 id='device_type-code-sources-idp-models-registrationdata-swift-56-code' class='heading'>Device_Type <code>../Sources/IDP/Models/RegistrationData.swift:56</code>:</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemF_Biometrie:A_21415:Device_Type]
/// [REQ:gemSpec_IDP_Frontend:A_21591]
public struct DeviceType: Codable {
</code></pre>
<h4 id='encrypted_registration_data-code-sources-idp-models-registrationdata-swift-104-code-returns-jwe-encrypted-registration_data' class='heading'>Encrypted_Registration_Data <code>../Sources/IDP/Models/RegistrationData.swift:104</code>:  Returns JWE encrypted Registration_Data</h4>
<pre class="highlight plaintext"><code>/// [REQ:gemF_Biometrie:A_21415:Encrypted_Registration_Data] Returns JWE encrypted Registration_Data
/// [REQ:gemSpec_IDP_Frontend:A_21416] Encryption
func encrypted(with publicKey: BrainpoolP256r1.KeyExchange.PublicKey,
</code></pre>
<h4 id='signed_pairing_data-code-sources-idp-models-signedpairingdata-swift-12-code' class='heading'>Signed_Pairing_Data <code>../Sources/IDP/Models/SignedPairingData.swift:12</code>:</h4>
<pre class="highlight plaintext"><code>/// Signed (with eGK) version of `PairingData`.
/// [REQ:gemF_Biometrie:A_21415:Signed_Pairing_Data]
public struct SignedPairingData {
</code></pre>
<h3 id='a_21450' class='heading'>A_21450</h3>
<h4 id='pairing_entry-code-sources-idp-models-pairingentry-swift-12-code' class='heading'>Pairing_Entry <code>../Sources/IDP/Models/PairingEntry.swift:12</code>:</h4>
<pre class="highlight plaintext"><code>/// Represents stored data within the idp.
/// [REQ:gemF_Biometrie:A_21450:Pairing_Entry]
public struct PairingEntry: Equatable, Codable {
</code></pre>
<h2 id='gemspec_erp_apovzd' class='heading'>gemSpec_eRp_APOVZD</h2>
<h3 id='a_21154' class='heading'>A_21154</h3>
<h4 id='code-sources-erpapp-screens-pharmacy-search-pharmacysearchdomain-swift-268-code-if-user-defined-filters-contain-location-element-ask-for-permission' class='heading'><code>../Sources/eRpApp/Screens/Pharmacy/Search/PharmacySearchDomain.swift:268</code>:  If user defined filters contain location element, ask for permission</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_eRp_APOVZD:A_21154] If user defined filters contain location element, ask for permission
if filterOptions.contains(.currentLocation) {
</code></pre>
<h3 id='a_21779' class='heading'>A_21779</h3>
<h4 id='code-sources-pharmacy-modelsr4-bundle-location-swift-137-code-delivery-pharmacy' class='heading'><code>../Sources/Pharmacy/ModelsR4.Bundle+Location.swift:137</code>:  delivery pharmacy</h4>
<pre class="highlight plaintext"><code>// [[REQ:gemSpec_eRp_APOVZD:A_21779] delivery pharmacy
case "498":
</code></pre>
<h4 id='code-sources-pharmacy-modelsr4-bundle-location-swift-194-code-map-pickup-pharmacy' class='heading'><code>../Sources/Pharmacy/ModelsR4.Bundle+Location.swift:194</code>:  Map pickup pharmacy</h4>
<pre class="highlight plaintext"><code>// [[REQ:gemSpec_eRp_APOVZD:A_21779] Map pickup pharmacy
case "OUTPHARM":
</code></pre>
<h4 id='code-sources-pharmacy-modelsr4-bundle-location-swift-199-code-map-shipping-pharmacy' class='heading'><code>../Sources/Pharmacy/ModelsR4.Bundle+Location.swift:199</code>:  Map shipping pharmacy</h4>
<pre class="highlight plaintext"><code>// [[REQ:gemSpec_eRp_APOVZD:A_21779] Map shipping pharmacy
case "MOBL":
</code></pre>
<h2 id='gemspec_erp_fdv' class='heading'>gemSpec_eRp_Fdv</h2>
<h3 id='a_20032-01' class='heading'>A_20032-01</h3>
<h4 id='code-sources-truststore-x509truststore-swift-106-code' class='heading'><code>../Sources/TrustStore/X509TrustStore.swift:106</code>:</h4>
<pre class="highlight plaintext"><code>/// Match a collection of `OCSPResponse`s with the end entity certificates of this `X509TrustStore`.
/// Checks response status, revocation status for each certificate and validates the signer certificates of
///   the responses itself.
///
/// [REQ:gemSpec_Krypt:A_21218]
/// [REQ:gemSpec_eRp_Fdv:A_20032-01]
///
/// - Note: This function assumes that up-to-dateness of the responses itself has already been checked.
///
/// - Returns: true on successful matching/validation, false if not successful or error
func checkEeCertificatesStatus(with ocspResponses: [OCSPResponse]) throws -&gt; Bool {
</code></pre>
<h2 id='gemspec_bsi_fdv' class='heading'>gemSpec_BSI_FdV</h2>
<h3 id='a_20834' class='heading'>A_20834</h3>
<h4 id='code-sources-erpapp-scenedelegate-swift-162-code-mandatory-app-authentication' class='heading'><code>../Sources/eRpApp/SceneDelegate.swift:162</code>:  mandatory app authentication</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_BSI_FdV:A_20834] mandatory app authentication
rootView: AppAuthenticationView(store: appAuthenticationStore)
</code></pre>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingcontainer-swift-41-code-view-to-register-authentication-in-onboarding-process' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingContainer.swift:41</code>:  view to register authentication in onboarding process</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_BSI_FdV:A_20834] view to register authentication in onboarding process
OnboardingAltRegisterAuthenticationView(
</code></pre>
<h4 id='code-sources-erpapp-screens-onboarding-onboardingcontainer-swift-59-code-view-to-register-authentication-in-onboarding-process' class='heading'><code>../Sources/eRpApp/Screens/Onboarding/OnboardingContainer.swift:59</code>:  view to register authentication in onboarding process</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_BSI_FdV:A_20834] view to register authentication in onboarding process
OnboardingRegisterAuthenticationView(
</code></pre>
<h3 id='a_20937' class='heading'>A_20937</h3>
<h4 id='code-sources-erpapp-session-helper-devicesecuritymanager-swift-110-code-jailbreak-detection' class='heading'><code>../Sources/eRpApp/Session/Helper/DeviceSecurityManager.swift:110</code>:  Jailbreak detection</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_BSI_FdV:A_20937] Jailbreak detection
func informJailbreakDetected() -&gt; Bool {
</code></pre>
<h3 id='a_20938' class='heading'>A_20938</h3>
<h4 id='code-sources-erpapp-screens-main-devicesecurity-devicesecurityrooteddevice-devicesecurityrooteddeviceview-swift-8-code-jailbreak-information-view' class='heading'><code>../Sources/eRpApp/Screens/Main/DeviceSecurity/DeviceSecurityRootedDevice/DeviceSecurityRootedDeviceView.swift:8</code>:  Jailbreak information view</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_BSI_FdV:A_20938] Jailbreak information view
struct DeviceSecurityRootedDeviceView: View {
</code></pre>
<h3 id='o-tokn_9' class='heading'>O.Tokn_9</h3>
<h4 id='code-sources-erpapp-screens-settings-idptokenview-idptokenview-swift-9-code-actual-view-that-presents-the-token' class='heading'><code>../Sources/eRpApp/Screens/Settings/IDPTokenView/IDPTokenView.swift:9</code>:  actual view that presents the token</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_BSI_FdV:O.Tokn_9] actual view that presents the token
struct IDPTokenView: View {
</code></pre>
<h4 id='code-sources-erpapp-screens-settings-profiles-edit-editprofiledomain-swift-193-code-observe-token-updates' class='heading'><code>../Sources/eRpApp/Screens/Settings/Profiles/Edit/EditProfileDomain.swift:193</code>:  observe token updates</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_BSI_FdV:O.Tokn_9] observe token updates
environment.subscribeToTokenUpdates(for: state.profileId)
</code></pre>
<h2 id='gemspec_fd_erp' class='heading'>gemSpec_FD_eRp</h2>
<h3 id='a_19145' class='heading'>A_19145</h3>
<h4 id='code-sources-erpapp-screens-main-prescriptionlist-model-prescription-swift-203-code-prevent-deletion-while-task-is-in-progress' class='heading'><code>../Sources/eRpApp/Screens/Main/PrescriptionList/Model/Prescription.swift:203</code>:  prevent deletion while task is in progress</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_FD_eRp:A_19145] prevent deletion while task is in progress
return erxTask.status != .inProgress
</code></pre>
<h3 id='a_21267' class='heading'>A_21267</h3>
<h4 id='code-sources-erpapp-screens-main-prescriptionlist-model-prescription-swift-29-code-direct-assignment' class='heading'><code>../Sources/eRpApp/Screens/Main/PrescriptionList/Model/Prescription.swift:29</code>:  direct assignment</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_FD_eRp:A_21267] direct assignment
var type: PrescriptionType = .regular
</code></pre>
<h3 id='a_21360' class='heading'>A_21360</h3>
<h4 id='code-sources-erpapp-screens-main-prescriptionlist-model-prescription-swift-167-code-no-redeem-informations-available-for-flowtype-169' class='heading'><code>../Sources/eRpApp/Screens/Main/PrescriptionList/Model/Prescription.swift:167</code>:  no redeem informations available for flowtype 169</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_FD_eRp:A_21360] no redeem informations available for flowtype 169
guard type != .directAssignment
</code></pre>
<h3 id='a_22102' class='heading'>A_22102</h3>
<h4 id='code-sources-erpapp-screens-main-prescriptionlist-model-prescription-swift-195-code-prevent-deletion-of-tasks-with-flowtype-169-while-not-completed' class='heading'><code>../Sources/eRpApp/Screens/Main/PrescriptionList/Model/Prescription.swift:195</code>:  prevent deletion of tasks with flowtype 169 while not completed</h4>
<pre class="highlight plaintext"><code>// [REQ:gemSpec_FD_eRp:A_22102] prevent deletion of tasks with flowtype 169 while not completed
guard type != .directAssignment
</code></pre>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2023 <a class="link" href="https://www.gematik.de" target="_blank" rel="external noopener">gematik GmbH</a>. All rights reserved. (Last updated: 2023-07-28)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external noopener">jazzy ♪♫ v0.14.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external noopener">Realm</a> project.</p>
    </section>
  </body>
</html>
